<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="alternate icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTUiIGZpbGw9IiMzNDk4ZGIiIHN0cm9rZT0iIzJjM2U1MCIgc3Ryb2tlLXdpZHRoPSIyIi8+PGcgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPjx0ZXh0IHg9IjE2IiB5PSIxMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMiI+ZDwvdGV4dD48bGluZSB4MT0iOCIgeTE9IjE2IiB4Mj0iMjQiIHkyPSIxNiIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIxLjUiLz48dGV4dCB4PSIxNiIgeT0iMjUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTAiPmR4PC90ZXh0PjwvZz48L3N2Zz4=">
    <title>2.2 函数的求导法则 - 高等数学复习</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            },
            chtml: {
                fontURL: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 50%, #a93226 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            margin-bottom: 20px;
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 15px;
            border-radius: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .back-link:hover {
            color: #2980b9;
            transform: translateX(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        
        .back-link::before {
            content: '←';
            margin-right: 8px;
            font-size: 1.2em;
        }
        
        header {
            background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            font-weight: 300;
        }
        
        .subtitle {
            font-size: 1.1em;
            margin-top: 10px;
            opacity: 0.9;
        }
        
        .content-section {
            background: white;
            margin: 25px 0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .content-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .section-header {
            padding: 20px 30px;
            background: linear-gradient(45deg, #c0392b, #a93226);
            color: white;
        }
        
        .section-header h2 {
            margin: 0;
            font-size: 1.6em;
            font-weight: 400;
        }
        
        .section-content {
            padding: 30px;
        }
        
        .definition {
            background: linear-gradient(135deg, #fadbd8, #f5b7b1);
            border-left: 5px solid #e74c3c;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(231, 76, 60, 0.1);
        }
        
        .definition h4 {
            margin: 0 0 15px 0;
            color: #e74c3c;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .theorem {
            background: linear-gradient(135deg, #d5f4e6, #82e0aa);
            border-left: 5px solid #27ae60;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(39, 174, 96, 0.1);
        }
        
        .theorem h4 {
            margin: 0 0 15px 0;
            color: #27ae60;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .example {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            border-left: 5px solid #2ecc71;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(46, 204, 113, 0.1);
        }
        
        .example h4 {
            margin: 0 0 15px 0;
            color: #2ecc71;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .practice-problem {
            background: linear-gradient(135deg, #fdeaa7, #f7dc6f);
            border-left: 5px solid #f1c40f;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(241, 196, 15, 0.1);
        }
        
        .practice-problem h4 {
            margin: 0 0 15px 0;
            color: #f1c40f;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .difficulty {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 500;
            margin-left: 10px;
        }
        
        .difficulty.medium {
            background: #ff9800;
            color: white;
        }
        
        .difficulty.hard {
            background: #e74c3c;
            color: white;
        }
        
        .difficulty.very-hard {
            background: #8e44ad;
            color: white;
        }
        
        .solution {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed #bdc3c7;
            display: none;
        }
        
        .solution.show {
            display: block;
        }
        
        .solution-header {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .solution-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s ease;
        }
        
        .solution-btn:hover {
            transform: translateY(-1px);
        }
        
        .viz-container {
            width: 100%;
            height: 400px;
            margin: 25px 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .interactive-demo {
            width: 100%;
            height: auto;
            min-height: 500px;
            margin: 25px 0;
            background: #f8f9fa;
            border-radius: 10px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            padding: 20px;
            position: relative;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .controls label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #e74c3c;
        }
        
        .controls input, .controls select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding: 20px 0;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 25px;
            background: linear-gradient(45deg, #c0392b, #a93226);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 3px 15px rgba(192, 57, 43, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(192, 57, 43, 0.4);
        }
        
        .btn.prev::before {
            content: '←';
            margin-right: 8px;
            font-size: 1.1em;
        }
        
        .btn.next::after {
            content: '→';
            margin-left: 8px;
            font-size: 1.1em;
        }
        
        footer {
            text-align: center;
            color: white;
            padding: 30px 0;
            opacity: 0.9;
            margin-top: 50px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        footer p {
            text-align: center;
            margin: 0;
        }
        
        .math-expression {
            text-align: center;
            margin: 15px 0;
            font-size: 1.1em;
        }
        
        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        .highlight {
            background: linear-gradient(135deg, #fadbd8, #f5b7b1);
            padding: 15px;
            border-left: 4px solid #e74c3c;
            border-radius: 0 8px 8px 0;
            margin: 15px 0;
        }
        
        .key-points {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
        }
        
        .point-card {
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
            background: #fadbd8;
            padding: 12px 18px;
            margin: 5px;
            border-radius: 20px;
            border: 2px solid #e74c3c;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            transform: scale(1) !important;
        }
        
        .point-card:hover {
            background: #e74c3c;
            color: white;
            transform: scale(1.05) !important;
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }
        
        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .formula-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }
        
        .formula-card h5 {
            margin-bottom: 10px;
            color: #fff;
            font-size: 1.1em;
        }

        /* AI提示方块样式 */
        .ai-warning {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            border: 2px solid #e0e0e0;
        }
        
        .ai-warning:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            border-color: #ff4444;
        }
        
        .ai-warning::before {
            content: '!';
            color: #e74c3c;
            font-size: 20px;
            font-weight: bold;
            font-family: Arial, sans-serif;
        }
        
        .ai-warning-tooltip {
            position: absolute;
            top: 50px;
            left: 0;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 16px 20px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
            width: 250px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .ai-warning-tooltip::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid rgba(0, 0, 0, 0.9);
        }
        
        .ai-warning:hover .ai-warning-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .definition, .theorem, .example, .practice-problem {
                padding: 20px;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .formula-grid {
                grid-template-columns: 1fr;
            }

            .ai-warning {
                width: 35px;
                height: 35px;
                top: 15px;
                left: 15px;
            }
            
            .ai-warning::before {
                font-size: 18px;
            }
            
            .ai-warning-tooltip {
                width: 280px;
                font-size: 13px;
                padding: 14px 18px;
            }
        }
    </style>
</head>
<body>
    <!-- AI内容提示 -->
    <div class="ai-warning">
        <div class="ai-warning-tooltip">
            页面内容由AI生成，请谨慎对待。<br>如发现错误，<a href="https://github.com/learn-advanced-math/learn-advanced-math.github.io/issues" target="_blank" style="color: #ff0000">欢迎反馈</a>。
        </div>
    </div>

    <div class="container">
        <a href="../index.html" class="back-link">返回章节概览</a>
        
        <header>
            <h1>2.2 函数的求导法则</h1>
            <div class="subtitle">Differentiation Rules for Functions</div>
        </header>

        <!-- 2.2.1 函数的和差积商的求导法则 -->
        <div class="content-section">
            <div class="section-header">
                <h2>2.2.1 函数的和差积商的求导法则</h2>
            </div>
            <div class="section-content">
                <div class="theorem">
                    <h4>四则运算求导法则</h4>
                    <p>设函数 $u = u(x)$、$v = v(x)$ 在点 $x$ 处可导，则：</p>
                    
                    <div class="formula-grid">
                        <div class="formula-card">
                            <h5>加法法则</h5>
                            <div class="math-expression">$(u + v)' = u' + v'$</div>
                        </div>
                        <div class="formula-card">
                            <h5>减法法则</h5>
                            <div class="math-expression">$(u - v)' = u' - v'$</div>
                        </div>
                        <div class="formula-card">
                            <h5>常数因子法则</h5>
                            <div class="math-expression">$(cu)' = cu'$</div>
                        </div>
                        <div class="formula-card">
                            <h5>乘法法则（莱布尼兹公式）</h5>
                            <div class="math-expression">$(uv)' = u'v + uv'$</div>
                        </div>
                        <div class="formula-card">
                            <h5>除法法则</h5>
                            <div class="math-expression">$\left(\frac{u}{v}\right)' = \frac{u'v - uv'}{v^2} \quad (v \neq 0)$</div>
                        </div>
                    </div>
                    
                    <div class="key-points">
                        <div class="point-card">线性运算保持导数的线性性</div>
                        <div class="point-card">乘法法则：前导后不导 + 前不导后导</div>
                        <div class="point-card">除法法则：分子导数公式</div>
                        <div class="point-card">常数因子可以提取到导数外</div>
                    </div>
                </div>

                <div class="example">
                    <h4>例1：基本运算法则应用</h4>
                    <p>求下列函数的导数：</p>
                    <p>$(1)$ $f(x) = 3x^2 + 2x - 5$</p>
                    <p>$(2)$ $g(x) = x^3 \sin x$</p>
                    <p>$(3)$ $h(x) = \frac{x^2 + 1}{x - 1}$</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p><strong>$(1)$ 求 $f'(x)$：</strong></p>
                        <div class="math-expression">
                            $$f'(x) = (3x^2)' + (2x)' - (5)' = 3 \cdot 2x + 2 - 0 = 6x + 2$$
                        </div>
                        
                        <p><strong>$(2)$ 求 $g'(x)$（使用乘法法则）：</strong></p>
                        <div class="math-expression">
                            $$g'(x) = (x^3)' \sin x + x^3 (\sin x)' = 3x^2 \sin x + x^3 \cos x$$
                        </div>
                        
                        <p><strong>$(3)$ 求 $h'(x)$（使用除法法则）：</strong></p>
                        <div class="math-expression">
                            $$h'(x) = \frac{(x^2 + 1)'(x - 1) - (x^2 + 1)(x - 1)'}{(x - 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{2x(x - 1) - (x^2 + 1) \cdot 1}{(x - 1)^2} = \frac{2x^2 - 2x - x^2 - 1}{(x - 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{x^2 - 2x - 1}{(x - 1)^2}$$
                        </div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <div class="controls">
                        <div class="control-group">
                            <label for="func1-select">选择函数 $u(x)$：</label>
                            <select id="func1-select">
                                <option value="x2">x^2</option>
                                <option value="x3">x^3</option>
                                <option value="sin">sin(x)</option>
                                <option value="exp">e^x</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label for="func2-select">选择函数 $v(x)$：</label>
                            <select id="func2-select">
                                <option value="x">x</option>
                                <option value="cos">cos(x)</option>
                                <option value="ln">ln(x)</option>
                                <option value="sqrt">sqrt{x}</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label for="operation-select">选择运算：</label>
                            <select id="operation-select">
                                <option value="add">$u(x) + v(x)$</option>
                                <option value="multiply">$u(x) \cdot v(x)$</option>
                                <option value="divide">$u(x) / v(x)$</option>
                            </select>
                        </div>
                    </div>
                    <div id="derivative-rules-plot" class="viz-container"></div>
                </div>

                <div class="practice-problem">
                    <h4>习题1 <span class="difficulty medium">中等难度</span></h4>
                    <p>求函数 $f(x) = x^2 e^x$ 的导数。</p>
                    <button class="solution-btn" onclick="toggleSolution(1)">显示解答</button>
                    
                    <div class="solution" id="solution1">
                        <div class="solution-header">解：</div>
                        <p>使用乘法法则：$(uv)' = u'v + uv'$</p>
                        <p>设 $u = x^2$，$v = e^x$</p>
                        <p>则 $u' = 2x$，$v' = e^x$</p>
                        <div class="math-expression">
                            $$f'(x) = (x^2)' \cdot e^x + x^2 \cdot (e^x)' = 2x \cdot e^x + x^2 \cdot e^x = e^x(2x + x^2) = x(x + 2)e^x$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题2 <span class="difficulty hard">较难</span></h4>
                    <p>求函数 $g(x) = \frac{x \sin x}{\cos x + 1}$ 的导数。</p>
                    <button class="solution-btn" onclick="toggleSolution(2)">显示解答</button>
                    
                    <div class="solution" id="solution2">
                        <div class="solution-header">解：</div>
                        <p>首先对分子 $x \sin x$ 用乘法法则：</p>
                        <div class="math-expression">
                            $$(x \sin x)' = x' \sin x + x (\sin x)' = \sin x + x \cos x$$
                        </div>
                        <p>分母 $\cos x + 1$ 的导数：</p>
                        <div class="math-expression">
                            $$(\cos x + 1)' = -\sin x$$
                        </div>
                        <p>使用除法法则：</p>
                        <div class="math-expression">
                            $$g'(x) = \frac{(\sin x + x \cos x)(\cos x + 1) - x \sin x (-\sin x)}{(\cos x + 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{(\sin x + x \cos x)(\cos x + 1) + x \sin^2 x}{(\cos x + 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{\sin x \cos x + \sin x + x \cos^2 x + x \cos x + x \sin^2 x}{(\cos x + 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{\sin x (\cos x + 1) + x(\cos^2 x + \sin^2 x) + x \cos x}{(\cos x + 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{\sin x (\cos x + 1) + x + x \cos x}{(\cos x + 1)^2}$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题3 <span class="difficulty very-hard">很难</span></h4>
                    <p>设 $f(x) = x^n$ ($n$ 为正整数)，证明：$(x^n)' = nx^{n-1}$。并利用此结果和乘法法则证明：$(x^m \cdot x^n)' = (m+n)x^{m+n-1}$。</p>
                    <button class="solution-btn" onclick="toggleSolution(3)">显示解答</button>
                    
                    <div class="solution" id="solution3">
                        <div class="solution-header">证明：</div>
                        <p><strong>第一部分：证明 $(x^n)' = nx^{n-1}$</strong></p>
                        <p>使用数学归纳法：</p>
                        <p><strong>基础步骤：</strong>当 $n = 1$ 时，$(x^1)' = x' = 1 = 1 \cdot x^0$，公式成立。</p>
                        <p><strong>归纳假设：</strong>假设对于 $k \geq 1$，有 $(x^k)' = kx^{k-1}$。</p>
                        <p><strong>归纳步骤：</strong>需证明 $(x^{k+1})' = (k+1)x^k$。</p>
                        <p>因为 $x^{k+1} = x \cdot x^k$，使用乘法法则：</p>
                        <div class="math-expression">
                            $$(x^{k+1})' = (x \cdot x^k)' = x' \cdot x^k + x \cdot (x^k)'$$
                        </div>
                        <div class="math-expression">
                            $$= 1 \cdot x^k + x \cdot kx^{k-1} = x^k + kx^k = (1+k)x^k = (k+1)x^k$$
                        </div>
                        <p>由数学归纳法，公式对所有正整数 $n$ 成立。</p>
                        
                        <p><strong>第二部分：证明 $(x^m \cdot x^n)' = (m+n)x^{m+n-1}$</strong></p>
                        <p>首先注意到 $x^m \cdot x^n = x^{m+n}$，因此：</p>
                        <div class="math-expression">
                            $$(x^m \cdot x^n)' = (x^{m+n})' = (m+n)x^{m+n-1}$$
                        </div>
                        <p>另一方面，使用乘法法则：</p>
                        <div class="math-expression">
                            $$(x^m \cdot x^n)' = (x^m)' \cdot x^n + x^m \cdot (x^n)' = mx^{m-1} \cdot x^n + x^m \cdot nx^{n-1}$$
                        </div>
                        <div class="math-expression">
                            $$= mx^{m+n-1} + nx^{m+n-1} = (m+n)x^{m+n-1}$$
                        </div>
                        <p>两种方法得到相同结果，证明完毕。 $\square$</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2.2.2 反函数的求导法则 -->
        <div class="content-section">
            <div class="section-header">
                <h2>2.2.2 反函数的求导法则</h2>
            </div>
            <div class="section-content">
                <div class="theorem">
                    <h4>反函数求导法则</h4>
                    <p>设函数 $y = f(x)$ 在区间 $(a, b)$ 内单调可导，且 $f'(x) \neq 0$，则其反函数 $x = \varphi(y)$ 在对应区间内也可导，且</p>
                    
                    <div class="math-expression">
                        $$\varphi'(y) = \frac{1}{f'(x)} \quad \text{或} \quad \frac{dx}{dy} = \frac{1}{\frac{dy}{dx}}$$
                    </div>
                    
                    <div class="highlight">
                        <strong>记忆要点：</strong>反函数的导数等于原函数导数的倒数
                    </div>
                    
                    <p><strong>证明思路：</strong></p>
                    <p>由 $y = f(x)$ 和 $x = \varphi(y)$ 的复合关系，有：$x = \varphi(f(x))$</p>
                    <p>两边对 $x$ 求导：$1 = \varphi'(f(x)) \cdot f'(x)$</p>
                    <p>因此：$\varphi'(f(x)) = \frac{1}{f'(x)}$，即 $\varphi'(y) = \frac{1}{f'(x)}$</p>
                </div>

                <div class="example">
                    <h4>例2：反函数求导应用</h4>
                    <p>已知 $y = x^3 + x + 1$，求其反函数在点 $y = 3$ 处的导数。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p><strong>第一步：</strong>找到 $y = 3$ 对应的 $x$ 值</p>
                        <p>当 $y = 3$ 时，$x^3 + x + 1 = 3$，即 $x^3 + x - 2 = 0$</p>
                        <p>可以验证 $x = 1$ 是该方程的解（$1^3 + 1 - 2 = 0$）</p>
                        
                        <p><strong>第二步：</strong>计算原函数在 $x = 1$ 处的导数</p>
                        <div class="math-expression">
                            $$\frac{dy}{dx} = 3x^2 + 1$$
                        </div>
                        <p>当 $x = 1$ 时，$\frac{dy}{dx}\bigg|_{x=1} = 3 \cdot 1^2 + 1 = 4$</p>
                        
                        <p><strong>第三步：</strong>应用反函数求导法则</p>
                        <div class="math-expression">
                            $$\frac{dx}{dy}\bigg|_{y=3} = \frac{1}{\frac{dy}{dx}\bigg|_{x=1}} = \frac{1}{4}$$
                        </div>
                        
                        <p><strong>答案：</strong>反函数在点 $y = 3$ 处的导数为 $\frac{1}{4}$。</p>
                    </div>
                </div>

                <div class="example">
                    <h4>例3：常见反函数的导数公式推导</h4>
                    <p>利用反函数求导法则推导 $(\arcsin x)' = \frac{1}{\sqrt{1-x^2}}$。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p>设 $y = \arcsin x$，则 $x = \sin y$，其中 $y \in \left[-\frac{\pi}{2}, \frac{\pi}{2}\right]$</p>
                        
                        <p><strong>第一步：</strong>求原函数的导数</p>
                        <div class="math-expression">
                            $$\frac{dx}{dy} = (\sin y)' = \cos y$$
                        </div>
                        
                        <p><strong>第二步：</strong>应用反函数求导法则</p>
                        <div class="math-expression">
                            $$\frac{dy}{dx} = \frac{1}{\frac{dx}{dy}} = \frac{1}{\cos y}$$
                        </div>
                        
                        <p><strong>第三步：</strong>用 $x$ 表示结果</p>
                        <p>由于 $x = \sin y$ 且 $y \in \left[-\frac{\pi}{2}, \frac{\pi}{2}\right]$，在此区间内 $\cos y \geq 0$</p>
                        <p>利用三角恒等式：$\cos^2 y + \sin^2 y = 1$</p>
                        <div class="math-expression">
                            $$\cos y = \sqrt{1 - \sin^2 y} = \sqrt{1 - x^2}$$
                        </div>
                        
                        <p>因此：</p>
                        <div class="math-expression">
                            $$(\arcsin x)' = \frac{1}{\cos y} = \frac{1}{\sqrt{1 - x^2}}$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题4 <span class="difficulty medium">中等难度</span></h4>
                    <p>设 $y = x + e^x$，求其反函数的导数 $\frac{dx}{dy}$。</p>
                    <button class="solution-btn" onclick="toggleSolution(4)">显示解答</button>
                    
                    <div class="solution" id="solution4">
                        <div class="solution-header">解：</div>
                        <p>首先求原函数的导数：</p>
                        <div class="math-expression">
                            $$\frac{dy}{dx} = (x + e^x)' = 1 + e^x$$
                        </div>
                        <p>由于 $e^x > 0$ 对所有 $x$ 成立，所以 $\frac{dy}{dx} = 1 + e^x > 1 > 0$</p>
                        <p>因此原函数在整个定义域内单调递增，反函数存在。</p>
                        <p>应用反函数求导法则：</p>
                        <div class="math-expression">
                            $$\frac{dx}{dy} = \frac{1}{\frac{dy}{dx}} = \frac{1}{1 + e^x}$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题5 <span class="difficulty hard">较难</span></h4>
                    <p>利用反函数求导法则推导 $(\arctan x)' = \frac{1}{1 + x^2}$。</p>
                    <button class="solution-btn" onclick="toggleSolution(5)">显示解答</button>
                    
                    <div class="solution" id="solution5">
                        <div class="solution-header">解：</div>
                        <p>设 $y = \arctan x$，则 $x = \tan y$，其中 $y \in \left(-\frac{\pi}{2}, \frac{\pi}{2}\right)$</p>
                        
                        <p><strong>第一步：</strong>求原函数的导数</p>
                        <div class="math-expression">
                            $$\frac{dx}{dy} = (\tan y)' = \sec^2 y = \frac{1}{\cos^2 y}$$
                        </div>
                        
                        <p><strong>第二步：</strong>应用反函数求导法则</p>
                        <div class="math-expression">
                            $$\frac{dy}{dx} = \frac{1}{\frac{dx}{dy}} = \cos^2 y$$
                        </div>
                        
                        <p><strong>第三步：</strong>用 $x$ 表示结果</p>
                        <p>由 $x = \tan y$ 可得：$\frac{x}{\cos y} = \frac{\sin y}{\cos y} = \tan y$</p>
                        <p>因此：$x \cos y = \sin y$</p>
                        <p>平方后：$x^2 \cos^2 y = \sin^2 y$</p>
                        <p>利用 $\sin^2 y + \cos^2 y = 1$：</p>
                        <div class="math-expression">
                            $$x^2 \cos^2 y = 1 - \cos^2 y$$
                        </div>
                        <div class="math-expression">
                            $$(x^2 + 1) \cos^2 y = 1$$
                        </div>
                        <div class="math-expression">
                            $$\cos^2 y = \frac{1}{1 + x^2}$$
                        </div>
                        
                        <p>因此：</p>
                        <div class="math-expression">
                            $$(\arctan x)' = \cos^2 y = \frac{1}{1 + x^2}$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题6 <span class="difficulty very-hard">很难</span></h4>
                    <p>设函数 $f(x) = x^3 + px + q$ 在 $x = 1$ 处有反函数，且 $f(1) = 2$，$f'(1) = 4$。若反函数为 $g(y)$，求 $g'(2)$ 和 $g''(2)$。</p>
                    <button class="solution-btn" onclick="toggleSolution(6)">显示解答</button>
                    
                    <div class="solution" id="solution6">
                        <div class="solution-header">解：</div>
                        <p><strong>第一步：</strong>利用已知条件确定参数</p>
                        <p>$f(x) = x^3 + px + q$，$f'(x) = 3x^2 + p$</p>
                        <p>由 $f(1) = 2$：$1 + p + q = 2$，即 $p + q = 1$</p>
                        <p>由 $f'(1) = 4$：$3 + p = 4$，即 $p = 1$</p>
                        <p>因此 $q = 0$，所以 $f(x) = x^3 + x$</p>
                        
                        <p><strong>第二步：</strong>求 $g'(2)$</p>
                        <p>由于 $f(1) = 2$，所以当 $y = 2$ 时，$x = 1$</p>
                        <p>使用反函数求导法则：</p>
                        <div class="math-expression">
                            $$g'(2) = \frac{1}{f'(1)} = \frac{1}{4}$$
                        </div>
                        
                        <p><strong>第三步：</strong>求 $g''(2)$</p>
                        <p>对反函数求导法则 $g'(y) = \frac{1}{f'(x)}$ 再次求导：</p>
                        <div class="math-expression">
                            $$\frac{d}{dy}[g'(y)] = \frac{d}{dy}\left[\frac{1}{f'(x)}\right]$$
                        </div>
                        <p>使用链式法则：</p>
                        <div class="math-expression">
                            $$g''(y) = -\frac{f''(x)}{[f'(x)]^2} \cdot \frac{dx}{dy} = -\frac{f''(x)}{[f'(x)]^2} \cdot g'(y)$$
                        </div>
                        <div class="math-expression">
                            $$= -\frac{f''(x)}{[f'(x)]^3}$$
                        </div>
                        
                        <p>计算 $f''(x) = 6x$，在 $x = 1$ 处：$f''(1) = 6$</p>
                        <p>因此：</p>
                        <div class="math-expression">
                            $$g''(2) = -\frac{6}{4^3} = -\frac{6}{64} = -\frac{3}{32}$$
                        </div>
                        
                        <p><strong>答案：</strong>$g'(2) = \frac{1}{4}$，$g''(2) = -\frac{3}{32}$</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2.2.3 复合函数的求导法则 -->
        <div class="content-section">
            <div class="section-header">
                <h2>2.2.3 复合函数的求导法则</h2>
            </div>
            <div class="section-content">
                <div class="theorem">
                    <h4>复合函数求导法则（链式法则）</h4>
                    <p>设函数 $u = \varphi(x)$ 在点 $x$ 处可导，函数 $y = f(u)$ 在对应点 $u = \varphi(x)$ 处可导，则复合函数 $y = f(\varphi(x))$ 在点 $x$ 处可导，且</p>
                    
                    <div class="math-expression">
                        $$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx}$$
                    </div>
                    
                    <p>或写成：</p>
                    <div class="math-expression">
                        $$[f(\varphi(x))]' = f'(\varphi(x)) \cdot \varphi'(x)$$
                    </div>
                    
                    <div class="key-points">
                        <div class="point-card">外层函数对内层函数求导</div>
                        <div class="point-card">乘以内层函数对自变量求导</div>
                        <div class="point-card">可扩展到多层复合</div>
                        <div class="point-card">记忆：外导内不导，乘以内导</div>
                    </div>
                    
                    <div class="highlight">
                        <strong>多层复合：</strong>若 $y = f(u)$，$u = \varphi(v)$，$v = \psi(x)$，则
                        $$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dv} \cdot \frac{dv}{dx}$$
                    </div>
                </div>

                <div class="example">
                    <h4>例4：基本复合函数求导</h4>
                    <p>求下列函数的导数：</p>
                    <p>$(1)$ $y = \sin(2x + 1)$</p>
                    <p>$(2)$ $y = e^{x^2}$</p>
                    <p>$(3)$ $y = \ln(\cos x)$</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p><strong>$(1)$ 求 $(\sin(2x + 1))'$：</strong></p>
                        <p>外层函数：$f(u) = \sin u$，$f'(u) = \cos u$</p>
                        <p>内层函数：$u = 2x + 1$，$u' = 2$</p>
                        <div class="math-expression">
                            $$y' = \cos(2x + 1) \cdot 2 = 2\cos(2x + 1)$$
                        </div>
                        
                        <p><strong>$(2)$ 求 $(e^{x^2})'$：</strong></p>
                        <p>外层函数：$f(u) = e^u$，$f'(u) = e^u$</p>
                        <p>内层函数：$u = x^2$，$u' = 2x$</p>
                        <div class="math-expression">
                            $$y' = e^{x^2} \cdot 2x = 2xe^{x^2}$$
                        </div>
                        
                        <p><strong>$(3)$ 求 $(\ln(\cos x))'$：</strong></p>
                        <p>外层函数：$f(u) = \ln u$，$f'(u) = \frac{1}{u}$</p>
                        <p>内层函数：$u = \cos x$，$u' = -\sin x$</p>
                        <div class="math-expression">
                            $$y' = \frac{1}{\cos x} \cdot (-\sin x) = -\frac{\sin x}{\cos x} = -\tan x$$
                        </div>
                    </div>
                </div>

                <div class="example">
                    <h4>例5：多层复合函数</h4>
                    <p>求 $y = \sin^2(3x + 1)$ 的导数。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p>可以看作 $y = [\sin(3x + 1)]^2$，这是三层复合：</p>
                        <ul>
                            <li>最外层：$y = u^2$，其中 $u = \sin(3x + 1)$</li>
                            <li>中间层：$u = \sin v$，其中 $v = 3x + 1$</li>
                            <li>最内层：$v = 3x + 1$</li>
                        </ul>
                        
                        <p><strong>方法一：</strong>逐层求导</p>
                        <div class="math-expression">
                            $$\frac{dy}{du} = 2u = 2\sin(3x + 1)$$
                        </div>
                        <div class="math-expression">
                            $$\frac{du}{dv} = \cos v = \cos(3x + 1)$$
                        </div>
                        <div class="math-expression">
                            $$\frac{dv}{dx} = 3$$
                        </div>
                        <div class="math-expression">
                            $$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dv} \cdot \frac{dv}{dx} = 2\sin(3x + 1) \cdot \cos(3x + 1) \cdot 3$$
                        </div>
                        <div class="math-expression">
                            $$= 6\sin(3x + 1)\cos(3x + 1) = 3\sin(2(3x + 1)) = 3\sin(6x + 2)$$
                        </div>
                        
                        <p><strong>方法二：</strong>分步计算</p>
                        <p>设 $u = \sin(3x + 1)$，则 $y = u^2$</p>
                        <div class="math-expression">
                            $$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx} = 2u \cdot [\sin(3x + 1)]' = 2\sin(3x + 1) \cdot 3\cos(3x + 1)$$
                        </div>
                    </div>
                </div>

                <div class="interactive-demo">
                    <div class="controls">
                        <div class="control-group">
                            <label for="composite-outer">外层函数：</label>
                            <select id="composite-outer">
                                <option value="square">u^2</option>
                                <option value="sqrt">sqrt{u}</option>
                                <option value="sin">sin(u)</option>
                                <option value="exp">e^u</option>
                                <option value="ln">ln(u)</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label for="composite-inner">内层函数：</label>
                            <select id="composite-inner">
                                <option value="2x">2x</option>
                                <option value="x2">x^2</option>
                                <option value="sin">sin(x)</option>
                                <option value="exp">e^x</option>
                            </select>
                        </div>
                    </div>
                    <div id="composite-plot" class="viz-container"></div>
                </div>

                <div class="practice-problem">
                    <h4>习题7 <span class="difficulty medium">中等难度</span></h4>
                    <p>求函数 $y = \sqrt{1 + x^2}$ 的导数。</p>
                    <button class="solution-btn" onclick="toggleSolution(7)">显示解答</button>
                    
                    <div class="solution" id="solution7">
                        <div class="solution-header">解：</div>
                        <p>设 $u = 1 + x^2$，则 $y = \sqrt{u} = u^{1/2}$</p>
                        <p>外层函数：$f(u) = u^{1/2}$，$f'(u) = \frac{1}{2}u^{-1/2} = \frac{1}{2\sqrt{u}}$</p>
                        <p>内层函数：$u = 1 + x^2$，$u' = 2x$</p>
                        <div class="math-expression">
                            $$y' = \frac{1}{2\sqrt{1 + x^2}} \cdot 2x = \frac{x}{\sqrt{1 + x^2}}$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题8 <span class="difficulty hard">较难</span></h4>
                    <p>求函数 $y = \tan(\ln(x^2 + 1))$ 的导数。</p>
                    <button class="solution-btn" onclick="toggleSolution(8)">显示解答</button>
                    
                    <div class="solution" id="solution8">
                        <div class="solution-header">解：</div>
                        <p>这是三层复合函数：</p>
                        <ul>
                            <li>$y = \tan w$，其中 $w = \ln(x^2 + 1)$</li>
                            <li>$w = \ln v$，其中 $v = x^2 + 1$</li>
                            <li>$v = x^2 + 1$</li>
                        </ul>
                        
                        <p>逐步求导：</p>
                        <div class="math-expression">
                            $$\frac{dv}{dx} = 2x$$
                        </div>
                        <div class="math-expression">
                            $$\frac{dw}{dv} = \frac{1}{v} = \frac{1}{x^2 + 1}$$
                        </div>
                        <div class="math-expression">
                            $$\frac{dy}{dw} = \sec^2 w = \sec^2(\ln(x^2 + 1))$$
                        </div>
                        
                        <p>应用链式法则：</p>
                        <div class="math-expression">
                            $$\frac{dy}{dx} = \frac{dy}{dw} \cdot \frac{dw}{dv} \cdot \frac{dv}{dx} = \sec^2(\ln(x^2 + 1)) \cdot \frac{1}{x^2 + 1} \cdot 2x$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{2x\sec^2(\ln(x^2 + 1))}{x^2 + 1}$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题9 <span class="difficulty very-hard">很难</span></h4>
                    <p>设 $f(x)$ 可导，求 $y = f(\sin(x^2))$ 的导数。并证明：若 $f(x) = x$，则结果与直接计算 $\sin(x^2)$ 的导数一致。</p>
                    <button class="solution-btn" onclick="toggleSolution(9)">显示解答</button>
                    
                    <div class="solution" id="solution9">
                        <div class="solution-header">解：</div>
                        <p><strong>第一部分：</strong>求 $y = f(\sin(x^2))$ 的导数</p>
                        <p>这是三层复合：</p>
                        <ul>
                            <li>$y = f(u)$，其中 $u = \sin(x^2)$</li>
                            <li>$u = \sin v$，其中 $v = x^2$</li>
                            <li>$v = x^2$</li>
                        </ul>
                        
                        <p>应用链式法则：</p>
                        <div class="math-expression">
                            $$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dv} \cdot \frac{dv}{dx}$$
                        </div>
                        <div class="math-expression">
                            $$= f'(u) \cdot \cos v \cdot 2x = f'(\sin(x^2)) \cdot \cos(x^2) \cdot 2x$$
                        </div>
                        <div class="math-expression">
                            $$= 2x f'(\sin(x^2)) \cos(x^2)$$
                        </div>
                        
                        <p><strong>第二部分：</strong>验证特殊情况</p>
                        <p>当 $f(x) = x$ 时，$f'(x) = 1$，所以：</p>
                        <div class="math-expression">
                            $$y = f(\sin(x^2)) = \sin(x^2)$$
                        </div>
                        <div class="math-expression">
                            $$y' = 2x f'(\sin(x^2)) \cos(x^2) = 2x \cdot 1 \cdot \cos(x^2) = 2x\cos(x^2)$$
                        </div>
                        
                        <p>直接对 $\sin(x^2)$ 求导：</p>
                        <div class="math-expression">
                            $$[\sin(x^2)]' = \cos(x^2) \cdot (x^2)' = \cos(x^2) \cdot 2x = 2x\cos(x^2)$$
                        </div>
                        
                        <p><strong>结论：</strong>两种方法得到相同结果，验证了公式的正确性。 $\square$</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2.2.4 基本求导法则与求导公式；基本初等函数的求导法则 -->
        <div class="content-section">
            <div class="section-header">
                <h2>2.2.4 基本求导法则与求导公式；基本初等函数的求导法则</h2>
            </div>
            <div class="section-content">
                <div class="definition">
                    <h4>基本初等函数导数公式表</h4>
                    
                    <div class="formula-grid">
                        <div class="formula-card">
                            <h5>常数函数</h5>
                            <div class="math-expression">$(C)' = 0$</div>
                        </div>
                        <div class="formula-card">
                            <h5>幂函数</h5>
                            <div class="math-expression">$(x^{\alpha})' = \alpha x^{\alpha-1}$</div>
                        </div>
                        <div class="formula-card">
                            <h5>指数函数</h5>
                            <div class="math-expression">$(a^x)' = a^x \ln a$</div>
                            <div class="math-expression">$(e^x)' = e^x$</div>
                        </div>
                        <div class="formula-card">
                            <h5>对数函数</h5>
                            <div class="math-expression">$(\log_a x)' = \frac{1}{x \ln a}$</div>
                            <div class="math-expression">$(\ln x)' = \frac{1}{x}$</div>
                        </div>
                        <div class="formula-card">
                            <h5>三角函数</h5>
                            <div class="math-expression">$(\sin x)' = \cos x$</div>
                            <div class="math-expression">$(\cos x)' = -\sin x$</div>
                        </div>
                        <div class="formula-card">
                            <h5>三角函数续</h5>
                            <div class="math-expression">$(\tan x)' = \sec^2 x$</div>
                            <div class="math-expression">$(\cot x)' = -\csc^2 x$</div>
                        </div>
                        <div class="formula-card">
                            <h5>反三角函数</h5>
                            <div class="math-expression">$(\arcsin x)' = \frac{1}{\sqrt{1-x^2}}$</div>
                            <div class="math-expression">$(\arccos x)' = -\frac{1}{\sqrt{1-x^2}}$</div>
                        </div>
                        <div class="formula-card">
                            <h5>反三角函数续</h5>
                            <div class="math-expression">$(\arctan x)' = \frac{1}{1+x^2}$</div>
                            <div class="math-expression">$(\text{arccot } x)' = -\frac{1}{1+x^2}$</div>
                        </div>
                    </div>
                    
                    <div class="key-points">
                        <div class="point-card">掌握基本公式是关键</div>
                        <div class="point-card">反函数导数往往含根号</div>
                        <div class="point-card">三角函数导数有正负规律</div>
                        <div class="point-card">组合使用各种法则</div>
                    </div>
                </div>

                <div class="theorem">
                    <h4>综合求导策略</h4>
                    <p>对于复杂函数的求导，通常按以下步骤进行：</p>
                    <ol>
                        <li><strong>分析函数结构：</strong>确定是和差积商、复合、反函数等哪种形式</li>
                        <li><strong>选择适当法则：</strong>四则运算法则、链式法则、反函数求导法则等</li>
                        <li><strong>分解复杂度：</strong>将复杂函数分解为基本初等函数的组合</li>
                        <li><strong>逐步求导：</strong>按照法则逐步计算每一部分的导数</li>
                        <li><strong>化简整理：</strong>对最终结果进行代数化简</li>
                    </ol>
                    
                    <div class="highlight">
                        <strong>记忆诀窍：</strong>
                        <ul>
                            <li>指数函数导数还是自己乘ln底</li>
                            <li>对数函数导数是倒数除ln底</li>
                            <li>正弦余弦互导，正切秒割平方</li>
                            <li>反三角函数根号配一加减</li>
                        </ul>
                    </div>
                </div>

                <div class="example">
                    <h4>例6：综合求导练习</h4>
                    <p>求下列函数的导数：</p>
                    <p>$(1)$ $y = \frac{x^2 + 1}{\sqrt{x}}$</p>
                    <p>$(2)$ $y = x \arctan x$</p>
                    <p>$(3)$ $y = \frac{e^x \sin x}{x^2 + 1}$</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p><strong>$(1)$ $y = \frac{x^2 + 1}{\sqrt{x}} = \frac{x^2 + 1}{x^{1/2}} = x^{3/2} + x^{-1/2}$</strong></p>
                        <div class="math-expression">
                            $$y' = \frac{3}{2}x^{1/2} + \left(-\frac{1}{2}\right)x^{-3/2} = \frac{3\sqrt{x}}{2} - \frac{1}{2x^{3/2}}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{3x^2 - 1}{2x^{3/2}} = \frac{3x^2 - 1}{2x\sqrt{x}}$$
                        </div>
                        
                        <p><strong>$(2)$ $y = x \arctan x$（使用乘法法则）</strong></p>
                        <div class="math-expression">
                            $$y' = (x)' \arctan x + x (\arctan x)' = 1 \cdot \arctan x + x \cdot \frac{1}{1+x^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \arctan x + \frac{x}{1+x^2}$$
                        </div>
                        
                        <p><strong>$(3)$ $y = \frac{e^x \sin x}{x^2 + 1}$（使用除法法则和乘法法则）</strong></p>
                        <p>先求分子的导数：$(e^x \sin x)' = (e^x)' \sin x + e^x (\sin x)' = e^x \sin x + e^x \cos x = e^x(\sin x + \cos x)$</p>
                        <p>分母的导数：$(x^2 + 1)' = 2x$</p>
                        <div class="math-expression">
                            $$y' = \frac{e^x(\sin x + \cos x)(x^2 + 1) - e^x \sin x \cdot 2x}{(x^2 + 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{e^x(\sin x + \cos x)(x^2 + 1) - 2xe^x \sin x}{(x^2 + 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{e^x[\sin x(x^2 + 1 - 2x) + \cos x(x^2 + 1)]}{(x^2 + 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{e^x[\sin x(x^2 - 2x + 1) + \cos x(x^2 + 1)]}{(x^2 + 1)^2}$$
                        </div>
                        <div class="math-expression">
                            $$= \frac{e^x[\sin x(x - 1)^2 + \cos x(x^2 + 1)]}{(x^2 + 1)^2}$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题10 <span class="difficulty medium">中等难度</span></h4>
                    <p>求函数 $y = \ln(\sin x + \cos x)$ 的导数。</p>
                    <button class="solution-btn" onclick="toggleSolution(10)">显示解答</button>
                    
                    <div class="solution" id="solution10">
                        <div class="solution-header">解：</div>
                        <p>使用复合函数求导法则：</p>
                        <p>外层函数：$f(u) = \ln u$，$f'(u) = \frac{1}{u}$</p>
                        <p>内层函数：$u = \sin x + \cos x$，$u' = \cos x - \sin x$</p>
                        <div class="math-expression">
                            $$y' = \frac{1}{\sin x + \cos x} \cdot (\cos x - \sin x) = \frac{\cos x - \sin x}{\sin x + \cos x}$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题11 <span class="difficulty hard">较难</span></h4>
                    <p>求函数 $y = x^{\sin x}$ 的导数（提示：使用对数求导法）。</p>
                    <button class="solution-btn" onclick="toggleSolution(11)">显示解答</button>
                    
                    <div class="solution" id="solution11">
                        <div class="solution-header">解：</div>
                        <p>对于 $y = x^{\sin x}$ 这类函数，使用对数求导法：</p>
                        <p>两边取对数：</p>
                        <div class="math-expression">
                            $$\ln y = \ln(x^{\sin x}) = \sin x \ln x$$
                        </div>
                        
                        <p>两边对 $x$ 求导：</p>
                        <div class="math-expression">
                            $$\frac{1}{y} \cdot y' = (\sin x \ln x)'$$
                        </div>
                        
                        <p>右边使用乘法法则：</p>
                        <div class="math-expression">
                            $$(\sin x \ln x)' = (\sin x)' \ln x + \sin x (\ln x)' = \cos x \ln x + \sin x \cdot \frac{1}{x}$$
                        </div>
                        <div class="math-expression">
                            $$= \cos x \ln x + \frac{\sin x}{x}$$
                        </div>
                        
                        <p>因此：</p>
                        <div class="math-expression">
                            $$\frac{y'}{y} = \cos x \ln x + \frac{\sin x}{x}$$
                        </div>
                        <div class="math-expression">
                            $$y' = y \left(\cos x \ln x + \frac{\sin x}{x}\right) = x^{\sin x} \left(\cos x \ln x + \frac{\sin x}{x}\right)$$
                        </div>
                    </div>
                </div>

                <div class="practice-problem">
                    <h4>习题12 <span class="difficulty very-hard">很难</span></h4>
                    <p>设 $f(x) = \begin{cases} x^2 \sin \frac{1}{x} & x \neq 0 \\ 0 & x = 0 \end{cases}$，证明 $f(x)$ 在 $x = 0$ 处可导，并求 $f'(0)$。进一步求出 $f'(x)$ 在 $x \neq 0$ 时的表达式。</p>
                    <button class="solution-btn" onclick="toggleSolution(12)">显示解答</button>
                    
                    <div class="solution" id="solution12">
                        <div class="solution-header">解：</div>
                        <p><strong>第一步：证明 $f(x)$ 在 $x = 0$ 处可导</strong></p>
                        <p>使用导数定义：</p>
                        <div class="math-expression">
                            $$f'(0) = \lim_{h \to 0} \frac{f(h) - f(0)}{h} = \lim_{h \to 0} \frac{h^2 \sin \frac{1}{h} - 0}{h} = \lim_{h \to 0} h \sin \frac{1}{h}$$
                        </div>
                        
                        <p>由于 $|\sin \frac{1}{h}| \leq 1$，有：</p>
                        <div class="math-expression">
                            $$|h \sin \frac{1}{h}| \leq |h|$$
                        </div>
                        
                        <p>由夹逼定理：$\lim_{h \to 0} h \sin \frac{1}{h} = 0$</p>
                        <p>因此 $f'(0) = 0$，函数在 $x = 0$ 处可导。</p>
                        
                        <p><strong>第二步：求 $x \neq 0$ 时的 $f'(x)$</strong></p>
                        <p>当 $x \neq 0$ 时，$f(x) = x^2 \sin \frac{1}{x}$</p>
                        <p>使用乘法法则：</p>
                        <div class="math-expression">
                            $$f'(x) = (x^2)' \sin \frac{1}{x} + x^2 \left(\sin \frac{1}{x}\right)'$$
                        </div>
                        
                        <p>计算 $\left(\sin \frac{1}{x}\right)'$，使用链式法则：</p>
                        <div class="math-expression">
                            $$\left(\sin \frac{1}{x}\right)' = \cos \frac{1}{x} \cdot \left(\frac{1}{x}\right)' = \cos \frac{1}{x} \cdot \left(-\frac{1}{x^2}\right) = -\frac{\cos \frac{1}{x}}{x^2}$$
                        </div>
                        
                        <p>因此：</p>
                        <div class="math-expression">
                            $$f'(x) = 2x \sin \frac{1}{x} + x^2 \cdot \left(-\frac{\cos \frac{1}{x}}{x^2}\right) = 2x \sin \frac{1}{x} - \cos \frac{1}{x}$$
                        </div>
                        
                        <p><strong>结论：</strong></p>
                        <div class="math-expression">
                            $$f'(x) = \begin{cases} 2x \sin \frac{1}{x} - \cos \frac{1}{x} & x \neq 0 \\ 0 & x = 0 \end{cases}$$
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 导航按钮 -->
        <div class="nav-buttons">
            <a href="2.1.html" class="btn prev">上一节：2.1 导数的概念</a>
            <a href="2.3.html" class="btn next">下一节：2.3 高阶导数</a>
        </div>
        
        <!-- Footer -->
        <footer>
            <p>&copy; 2025 高等数学复习系统 - 函数的求导法则</p>
        </footer>
    </div>

    <script>
        // 复合函数求导演示
        function createCompositeDemo() {
            const plotDiv = document.getElementById('composite-plot');
            const outerSelect = document.getElementById('composite-outer');
            const innerSelect = document.getElementById('composite-inner');
            
            if (!plotDiv || !outerSelect || !innerSelect) {
                return;
            }
            
            function getOuterFunction(u, type) {
                switch(type) {
                    case 'square': return u * u;
                    case 'sqrt': return u >= 0 ? Math.sqrt(u) : NaN;
                    case 'sin': return Math.sin(u);
                    case 'exp': return Math.exp(u);
                    case 'ln': return u > 0 ? Math.log(u) : NaN;
                    default: return 0;
                }
            }
            
            function getOuterDerivative(u, type) {
                switch(type) {
                    case 'square': return 2 * u;
                    case 'sqrt': return u > 0 ? 1/(2*Math.sqrt(u)) : NaN;
                    case 'sin': return Math.cos(u);
                    case 'exp': return Math.exp(u);
                    case 'ln': return u > 0 ? 1/u : NaN;
                    default: return 0;
                }
            }
            
            function getInnerFunction(x, type) {
                switch(type) {
                    case '2x': return 2 * x;
                    case 'x2': return x * x;
                    case 'sin': return Math.sin(x);
                    case 'exp': return Math.exp(x);
                    default: return 0;
                }
            }
            
            function getInnerDerivative(x, type) {
                switch(type) {
                    case '2x': return 2;
                    case 'x2': return 2 * x;
                    case 'sin': return Math.cos(x);
                    case 'exp': return Math.exp(x);
                    default: return 0;
                }
            }
            
            function getFunctionName(type, isOuter = false) {
                if (isOuter) {
                    const names = {
                        'square': 'u²', 'sqrt': '√u', 'sin': 'sin u',
                        'exp': 'eᵘ', 'ln': 'ln u'
                    };
                    return names[type] || type;
                } else {
                    const names = {
                        '2x': '2x', 'x2': 'x²', 'sin': 'sin x', 'exp': 'eˣ'
                    };
                    return names[type] || type;
                }
            }
            
            function updatePlot() {
                const outerType = outerSelect.value;
                const innerType = innerSelect.value;
                
                const xValues = [];
                const uValues = [];
                const yValues = [];
                const derivativeValues = [];
                
                const xMin = -3;
                const xMax = 3;
                const step = (xMax - xMin) / 300;
                
                for (let x = xMin; x <= xMax; x += step) {
                    const u = getInnerFunction(x, innerType);
                    const y = getOuterFunction(u, outerType);
                    
                    // 链式法则：dy/dx = (dy/du) * (du/dx)
                    const dydu = getOuterDerivative(u, outerType);
                    const dudx = getInnerDerivative(x, innerType);
                    const dydx = dydu * dudx;
                    
                    if (!isNaN(y) && !isNaN(dydx) && Math.abs(y) < 20 && Math.abs(dydx) < 20) {
                        xValues.push(x);
                        uValues.push(u);
                        yValues.push(y);
                        derivativeValues.push(dydx);
                    }
                }
                
                const traces = [
                    {
                        x: xValues,
                        y: yValues,
                        mode: 'lines',
                        name: `复合函数: ${getFunctionName(outerType, true)}，其中 u = ${getFunctionName(innerType)}`,
                        line: { color: '#e74c3c', width: 3 }
                    },
                    {
                        x: xValues,
                        y: derivativeValues,
                        mode: 'lines',
                        name: '导数 (链式法则)',
                        line: { color: '#3498db', width: 2, dash: 'dash' }
                    },
                    {
                        x: xValues,
                        y: uValues,
                        mode: 'lines',
                        name: `内层函数: u = ${getFunctionName(innerType)}`,
                        line: { color: '#27ae60', width: 1, dash: 'dot' },
                        opacity: 0.7
                    }
                ];
                
                const layout = {
                    title: `复合函数求导演示：链式法则`,
                    xaxis: {
                        title: 'x',
                        range: [xMin, xMax],
                        zeroline: true,
                        gridcolor: 'rgba(0,0,0,0.1)'
                    },
                    yaxis: {
                        title: 'y',
                        zeroline: true,
                        gridcolor: 'rgba(0,0,0,0.1)'
                    },
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    showlegend: true,
                    legend: { x: 0.8, y: 0.98 }
                };
                
                Plotly.newPlot(plotDiv, traces, layout, {responsive: true});
            }
            
            // 事件监听器
            outerSelect.addEventListener('change', updatePlot);
            innerSelect.addEventListener('change', updatePlot);
            
            // 初始化
            updatePlot();
        }

        // 求导法则演示
        function createDerivativeRulesDemo() {
            const plotDiv = document.getElementById('derivative-rules-plot');
            const func1Select = document.getElementById('func1-select');
            const func2Select = document.getElementById('func2-select');
            const operationSelect = document.getElementById('operation-select');
            
            if (!plotDiv || !func1Select || !func2Select || !operationSelect) {
                return;
            }
            
            function getFunction(x, type) {
                switch(type) {
                    case 'x': return x;
                    case 'x2': return x * x;
                    case 'x3': return x * x * x;
                    case 'sin': return Math.sin(x);
                    case 'cos': return Math.cos(x);
                    case 'exp': return Math.exp(x);
                    case 'ln': return x > 0 ? Math.log(x) : NaN;
                    case 'sqrt': return x >= 0 ? Math.sqrt(x) : NaN;
                    default: return 0;
                }
            }
            
            function getDerivative(x, type) {
                switch(type) {
                    case 'x': return 1;
                    case 'x2': return 2 * x;
                    case 'x3': return 3 * x * x;
                    case 'sin': return Math.cos(x);
                    case 'cos': return -Math.sin(x);
                    case 'exp': return Math.exp(x);
                    case 'ln': return x > 0 ? 1/x : NaN;
                    case 'sqrt': return x > 0 ? 1/(2*Math.sqrt(x)) : NaN;
                    default: return 0;
                }
            }
            
            function getFunctionName(type) {
                const names = {
                    'x': 'x', 'x2': 'x²', 'x3': 'x³',
                    'sin': 'sin x', 'cos': 'cos x', 'exp': 'eˣ',
                    'ln': 'ln x', 'sqrt': '√x'
                };
                return names[type] || type;
            }
            
            function updatePlot() {
                const func1Type = func1Select.value;
                const func2Type = func2Select.value;
                const operation = operationSelect.value;
                
                const xValues = [];
                const y1Values = [];
                const y2Values = [];
                const resultValues = [];
                const derivative1Values = [];
                const derivative2Values = [];
                const derivativeResultValues = [];
                
                const xMin = operation === 'divide' || func2Type === 'ln' || func2Type === 'sqrt' ? 0.1 : -3;
                const xMax = 3;
                const step = (xMax - xMin) / 300;
                
                for (let x = xMin; x <= xMax; x += step) {
                    const f1 = getFunction(x, func1Type);
                    const f2 = getFunction(x, func2Type);
                    const df1 = getDerivative(x, func1Type);
                    const df2 = getDerivative(x, func2Type);
                    
                    let result, derivativeResult;
                    
                    switch(operation) {
                        case 'add':
                            result = f1 + f2;
                            derivativeResult = df1 + df2;
                            break;
                        case 'multiply':
                            result = f1 * f2;
                            derivativeResult = df1 * f2 + f1 * df2; // 乘法法则
                            break;
                        case 'divide':
                            if (Math.abs(f2) < 1e-10) continue;
                            result = f1 / f2;
                            derivativeResult = (df1 * f2 - f1 * df2) / (f2 * f2); // 除法法则
                            break;
                        default:
                            continue;
                    }
                    
                    if (!isNaN(result) && !isNaN(derivativeResult) && 
                        Math.abs(result) < 20 && Math.abs(derivativeResult) < 20) {
                        xValues.push(x);
                        y1Values.push(f1);
                        y2Values.push(f2);
                        resultValues.push(result);
                        derivative1Values.push(df1);
                        derivative2Values.push(df2);
                        derivativeResultValues.push(derivativeResult);
                    }
                }
                
                const traces = [
                    {
                        x: xValues,
                        y: resultValues,
                        mode: 'lines',
                        name: `函数: ${getFunctionName(func1Type)} ${operation === 'add' ? '+' : operation === 'multiply' ? '×' : '÷'} ${getFunctionName(func2Type)}`,
                        line: { color: '#e74c3c', width: 3 }
                    },
                    {
                        x: xValues,
                        y: derivativeResultValues,
                        mode: 'lines',
                        name: '导数',
                        line: { color: '#3498db', width: 2, dash: 'dash' }
                    }
                ];
                
                const layout = {
                    title: `求导法则演示：${operation === 'add' ? '和的导数' : operation === 'multiply' ? '积的导数（乘法法则）' : '商的导数（除法法则）'}`,
                    xaxis: {
                        title: 'x',
                        range: [xMin, xMax],
                        zeroline: true,
                        gridcolor: 'rgba(0,0,0,0.1)'
                    },
                    yaxis: {
                        title: 'y',
                        zeroline: true,
                        gridcolor: 'rgba(0,0,0,0.1)'
                    },
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    showlegend: true,
                    legend: { x: 0.02, y: 0.98 }
                };
                
                Plotly.newPlot(plotDiv, traces, layout, {responsive: true});
            }
            
            // 事件监听器
            func1Select.addEventListener('change', updatePlot);
            func2Select.addEventListener('change', updatePlot);
            operationSelect.addEventListener('change', updatePlot);
            
            // 初始化
            updatePlot();
        }

        // 页面加载动画
        function initializeAnimations() {
            const contentSections = document.querySelectorAll('.content-section');
            if (contentSections.length > 0 && typeof gsap !== 'undefined') {
                gsap.from('.content-section', {
                    duration: 0.8,
                    y: 30,
                    opacity: 0,
                    stagger: 0.2,
                    ease: "power2.out"
                });
            }
            
            // 确保卡片元素可见
            const pointCards = document.querySelectorAll('.point-card');
            pointCards.forEach(card => {
                card.style.display = 'inline-block';
                card.style.visibility = 'visible';
                card.style.opacity = '1';
                card.style.transform = 'scale(1)';
            });
            
            if (pointCards.length > 0 && typeof gsap !== 'undefined') {
                try {
                    gsap.fromTo('.point-card', 
                        {
                            scale: 0,
                            rotation: 180,
                            opacity: 0
                        },
                        {
                            duration: 0.6,
                            scale: 1,
                            rotation: 0,
                            opacity: 1,
                            stagger: 0.08,
                            delay: 1,
                            ease: "back.out(1.7)"
                        }
                    );
                } catch (error) {
                    console.log('GSAP animation failed, but elements are visible');
                }
            }
        }
        
        // 交互效果设置
        function setupCardInteractions() {
            const allCards = document.querySelectorAll('.point-card');
            allCards.forEach((card) => {
                card.addEventListener('mouseenter', function() {
                    if (typeof gsap !== 'undefined') {
                        gsap.to(this, { duration: 0.3, scale: 1.1, rotation: 2 });
                    }
                });
                
                card.addEventListener('mouseleave', function() {
                    if (typeof gsap !== 'undefined') {
                        gsap.to(this, { duration: 0.3, scale: 1, rotation: 0 });
                    }
                });
            });
        }
        
        // 滚动触发动画
        function setupScrollAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && typeof gsap !== 'undefined') {
                        gsap.from(entry.target.querySelectorAll('.math-expression'), {
                            duration: 0.8,
                            y: 20,
                            opacity: 0,
                            stagger: 0.1,
                            ease: "power2.out"
                        });
                    }
                });
            }, { threshold: 0.2 });
            
            document.querySelectorAll('.content-section').forEach(section => {
                observer.observe(section);
            });
        }

        // 实用工具函数
        function toggleSolution(id) {
            const solution = document.getElementById(`solution${id}`);
            if (solution) {
                solution.classList.toggle('show');
            }
        }

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 强制显示卡片内容
            const keyPoints = document.querySelector('.key-points');
            if (keyPoints) {
                keyPoints.style.display = 'flex';
                keyPoints.style.visibility = 'visible';
                keyPoints.style.opacity = '1';
                
                const cards = keyPoints.querySelectorAll('.point-card');
                cards.forEach(card => {
                    card.style.display = 'inline-block';
                    card.style.visibility = 'visible';
                    card.style.opacity = '1';
                    card.style.transform = 'scale(1)';
                });
                
                // 重新渲染 MathJax
                if (typeof MathJax !== 'undefined') {
                    MathJax.typesetPromise([keyPoints]).catch((err) => console.log(err));
                }
            }
            
            // 等待一段时间确保所有资源加载完毕
            setTimeout(() => {
                createDerivativeRulesDemo();
                createCompositeDemo();
                initializeAnimations();
                setupCardInteractions();
            }, 500);
            
            if (typeof MathJax !== 'undefined') {
                MathJax.startup.promise.then(() => {
                    setTimeout(() => {
                        setupScrollAnimations();
                    }, 500);
                });
            } else {
                setTimeout(() => {
                    setupScrollAnimations();
                }, 1500);
            }
        });
    </script>
</body>
</html>
