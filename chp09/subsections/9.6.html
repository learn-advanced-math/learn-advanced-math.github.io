<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="alternate icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTUiIGZpbGw9IiMzNDk4ZGIiIHN0cm9rZT0iIzJjM2U1MCIgc3Ryb2tlLXdpZHRoPSIyIi8+PGcgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPjx0ZXh0IHg9IjE2IiB5PSIxMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMiI+ZDwvdGV4dD48bGluZSB4MT0iOCIgeTE9IjE2IiB4Mj0iMjQiIHkyPSIxNiIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIxLjUiLz48dGV4dCB4PSIxNiIgeT0iMjUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTAiPmR4PC90ZXh0PjwvZz48L3N2Zz4=">
    <title>9.6 多元函数微分学的几何应用 - 高等数学复习</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            },
            chtml: {
                fontURL: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #6a5acd 0%, #9370db 50%, #8a2be2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            margin-bottom: 20px;
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 15px;
            border-radius: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .back-link:hover {
            color: #2980b9;
            transform: translateX(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        
        .back-link::before {
            content: '←';
            margin-right: 8px;
            font-size: 1.2em;
        }
        
        header {
            background: linear-gradient(135deg, #8a2be2 0%, #9932cc 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            font-weight: 300;
        }
        
        .subtitle {
            font-size: 1.1em;
            margin-top: 10px;
            opacity: 0.9;
        }
        
        .content-section {
            background: white;
            margin: 25px 0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .content-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .section-header {
            padding: 20px 30px;
            background: linear-gradient(45deg, #8a2be2, #9932cc);
            color: white;
        }
        
        .section-header h2 {
            margin: 0;
            font-size: 1.6em;
            font-weight: 400;
        }
        
        .section-content {
            padding: 30px;
        }
        
        .definition {
            background: linear-gradient(135deg, #f3f0ff, #e8e2ff);
            border-left: 5px solid #8a2be2;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(138, 43, 226, 0.1);
        }
        
        .definition h4 {
            margin: 0 0 15px 0;
            color: #8a2be2;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .theorem {
            background: linear-gradient(135deg, #fef9e7, #fcf4dd);
            border-left: 5px solid #f39c12;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(243, 156, 18, 0.1);
        }
        
        .theorem h4 {
            margin: 0 0 15px 0;
            color: #f39c12;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .example {
            background: linear-gradient(135deg, #ebf3fd, #d6e9f8);
            border-left: 5px solid #3498db;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(52, 152, 219, 0.1);
        }
        
        .example h4 {
            margin: 0 0 15px 0;
            color: #3498db;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .highlight {
            background: linear-gradient(135deg, #fff3cd, #fce4a0);
            padding: 15px;
            border-left: 4px solid #ffc107;
            border-radius: 0 8px 8px 0;
            margin: 15px 0;
        }
        
        .solution {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed #bdc3c7;
        }
        
        .solution-header {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding: 20px 0;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 25px;
            background: linear-gradient(45deg, #8a2be2, #9932cc);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 3px 15px rgba(138, 43, 226, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.4);
        }

        .btn.prev::before {
            content: '←';
            margin-right: 8px;
            font-size: 1.1em;
        }
        
        .btn.next::after {
            content: '→';
            margin-left: 8px;
            font-size: 1.1em;
        }

        footer {
            text-align: center;
            color: white;
            padding: 30px 0;
            opacity: 0.9;
            margin-top: 50px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        footer p {
            text-align: center;
            margin: 0;
        }
        
        .formula-box {
            background: linear-gradient(135deg, #f8f6ff, #ede8ff);
            border: 2px solid #8a2be2;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
        }
        
        .formula-title {
            color: #8a2be2;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .property-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .property-item {
            background: linear-gradient(135deg, #f9f6ff, #f0ebff);
            border: 2px solid #ba7fdb;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .property-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(186, 127, 219, 0.2);
            border-color: #8a2be2;
        }
        
        .property-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #8a2be2, #ba7fdb, #dda0dd);
        }
        
        .property-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: linear-gradient(45deg, #8a2be2, #9932cc);
            color: white;
            border-radius: 50%;
            font-weight: 600;
            font-size: 0.9em;
            margin-bottom: 15px;
        }
        
        .property-formula {
            font-size: 1.1em;
            color: #4a235a;
            line-height: 1.4;
        }
        
        .visualization-container {
            width: 100%;
            height: 600px;
            margin: 25px 0;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.1);
            overflow: hidden;
            position: relative;
        }
        
        .viz-header {
            background: linear-gradient(45deg, #8a2be2, #9932cc);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .viz-content {
            height: calc(100% - 60px);
            padding: 10px;
        }
        
        .viz-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #f8f6ff, #ede8ff);
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(138, 43, 226, 0.1);
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .viz-controls label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #8a2be2;
            font-size: 0.9em;
        }
        
        .viz-controls input, .viz-controls select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ba7fdb;
            border-radius: 5px;
            font-size: 14px;
        }

        /* AI提示方块样式 */
        .ai-warning {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            border: 2px solid #e0e0e0;
        }
        
        .ai-warning:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            border-color: #ff4444;
        }
        
        .ai-warning::before {
            content: '!';
            color: #e74c3c;
            font-size: 20px;
            font-weight: bold;
            font-family: Arial, sans-serif;
        }
        
        .ai-warning-tooltip {
            position: absolute;
            top: 50px;
            left: 0;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 16px 20px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
            width: 250px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .ai-warning-tooltip::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid rgba(0, 0, 0, 0.9);
        }
        
        .ai-warning:hover .ai-warning-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .definition, .theorem, .example {
                padding: 20px;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .ai-warning {
                width: 35px;
                height: 35px;
                top: 15px;
                left: 15px;
            }
            
            .ai-warning::before {
                font-size: 18px;
            }
            
            .ai-warning-tooltip {
                width: 280px;
                font-size: 13px;
                padding: 14px 18px;
            }
        }
    </style>
</head>
<body>
    <!-- AI内容提示 -->
    <div class="ai-warning">
        <div class="ai-warning-tooltip">
            页面内容由AI生成，请谨慎对待。<br>如发现错误，<a href="https://github.com/learn-advanced-math/learn-advanced-math.github.io/issues" target="_blank" style="color: #ff0000">欢迎反馈</a>。
        </div>
    </div>
    
    <div class="container">
        <a href="../index.html" class="back-link">返回章节概览</a>
        
        <header>
            <h1>9.6 多元函数微分学的几何应用</h1>
            <div class="subtitle">Geometric Applications of Multivariable Differential Calculus</div>
        </header>
        
        <!-- 9.6.1 一元向量值函数及其导数；导向量 -->
        <div class="content-section">
            <div class="section-header">
                <h2>9.6.1 一元向量值函数及其导数；导向量</h2>
            </div>
            <div class="section-content">
                <div class="definition">
                    <h4>一元向量值函数</h4>
                    <p>设 $t$ 是某个区间 $I$ 上的实变数，$\vec{r}(t)$ 是定义在 $I$ 上的向量值函数：</p>
                    $$\vec{r}(t) = x(t)\vec{i} + y(t)\vec{j} + z(t)\vec{k}$$
                    <p>其中 $x(t)$、$y(t)$、$z(t)$ 是 $t$ 的实值函数，称为向量值函数 $\vec{r}(t)$ 的<strong>分量函数</strong>。</p>
                    
                    <div class="highlight">
                        <p><strong>几何意义：</strong>当参数 $t$ 在区间 $I$ 内变化时，向量 $\vec{r}(t)$ 的终点在空间中描绘出一条<strong>参数曲线</strong>。</p>
                    </div>
                </div>
                
                <div class="definition">
                    <h4>向量值函数的导数（导向量）</h4>
                    <p>设向量值函数 $\vec{r}(t) = x(t)\vec{i} + y(t)\vec{j} + z(t)\vec{k}$ 在点 $t_0$ 处可导，则：</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">导向量公式</div>
                        $$\vec{r}'(t_0) = \lim_{\Delta t \to 0} \frac{\vec{r}(t_0 + \Delta t) - \vec{r}(t_0)}{\Delta t}$$
                        $$= x'(t_0)\vec{i} + y'(t_0)\vec{j} + z'(t_0)\vec{k}$$
                    </div>
                    
                    <p><strong>几何意义：</strong>$\vec{r}'(t_0)$ 是空间曲线在 $t = t_0$ 对应点处的<strong>切向量</strong>。</p>
                </div>
                
                <div class="theorem">
                    <h4>导向量的性质</h4>
                    <p>设 $\vec{u}(t)$ 和 $\vec{v}(t)$ 为可导的向量值函数，$f(t)$ 为可导的标量函数，则：</p>
                    
                    <div class="property-list">
                        <div class="property-item">
                            <div class="property-number">1</div>
                            <div class="property-formula">
                                $$[\vec{u}(t) + \vec{v}(t)]' = \vec{u}'(t) + \vec{v}'(t)$$
                                <p style="margin-top: 10px; font-size: 0.9em; color: #7b68ee;">向量和的导数等于导数的和</p>
                            </div>
                        </div>
                        
                        <div class="property-item">
                            <div class="property-number">2</div>
                            <div class="property-formula">
                                $$[f(t)\vec{u}(t)]' = f'(t)\vec{u}(t) + f(t)\vec{u}'(t)$$
                                <p style="margin-top: 10px; font-size: 0.9em; color: #7b68ee;">标量与向量积的求导法则</p>
                            </div>
                        </div>
                        
                        <div class="property-item">
                            <div class="property-number">3</div>
                            <div class="property-formula">
                                $$[\vec{u}(t) \cdot \vec{v}(t)]' = \vec{u}'(t) \cdot \vec{v}(t) + \vec{u}(t) \cdot \vec{v}'(t)$$
                                <p style="margin-top: 10px; font-size: 0.9em; color: #7b68ee;">向量数量积的求导法则</p>
                            </div>
                        </div>
                        
                        <div class="property-item">
                            <div class="property-number">4</div>
                            <div class="property-formula">
                                $$[\vec{u}(t) \times \vec{v}(t)]' = \vec{u}'(t) \times \vec{v}(t) + \vec{u}(t) \times \vec{v}'(t)$$
                                <p style="margin-top: 10px; font-size: 0.9em; color: #7b68ee;">向量叉积的求导法则</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="example">
                    <h4>例1：求向量值函数的导数</h4>
                    <p>设 $\vec{r}(t) = t^2\vec{i} + \sin t\vec{j} + e^t\vec{k}$，求 $\vec{r}'(t)$。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p>对各分量分别求导：</p>
                        $$\vec{r}'(t) = \frac{d}{dt}(t^2)\vec{i} + \frac{d}{dt}(\sin t)\vec{j} + \frac{d}{dt}(e^t)\vec{k}$$
                        $$= 2t\vec{i} + \cos t\vec{j} + e^t\vec{k}$$
                    </div>
                </div>
                
                <div class="example">
                    <h4>例2：证明圆周运动的导向量</h4>
                    <p>设质点在单位圆上作匀速圆周运动：$\vec{r}(t) = \cos t\vec{i} + \sin t\vec{j}$，证明 $\vec{r}'(t) \perp \vec{r}(t)$。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p>首先求导：</p>
                        $$\vec{r}'(t) = -\sin t\vec{i} + \cos t\vec{j}$$
                        <p>计算内积：</p>
                        $$\vec{r}(t) \cdot \vec{r}'(t) = \cos t \cdot (-\sin t) + \sin t \cdot \cos t = -\cos t \sin t + \sin t \cos t = 0$$
                        <p>因此 $\vec{r}'(t) \perp \vec{r}(t)$，即导向量垂直于位置向量。</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 9.6.2 空间曲线的切线与法平面 -->
        <div class="content-section">
            <div class="section-header">
                <h2>9.6.2 空间曲线的切线与法平面</h2>
            </div>
            <div class="section-content">
                <div class="definition">
                    <h4>空间曲线的参数表示</h4>
                    <p>空间曲线 $C$ 可以用参数方程表示为：</p>
                    $$\begin{cases}
                    x = x(t) \\
                    y = y(t) \\
                    z = z(t)
                    \end{cases}, \quad t \in [a, b]$$
                    <p>或用向量形式：$\vec{r}(t) = x(t)\vec{i} + y(t)\vec{j} + z(t)\vec{k}$</p>
                </div>
                
                <div class="theorem">
                    <h4>空间曲线的切线方程</h4>
                    <p>设空间曲线 $C$ 的参数方程为 $\vec{r}(t) = x(t)\vec{i} + y(t)\vec{j} + z(t)\vec{k}$，在点 $M_0(x_0, y_0, z_0)$（对应参数 $t_0$）处的切线方程为：</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">切线方程</div>
                        $$\frac{x - x_0}{x'(t_0)} = \frac{y - y_0}{y'(t_0)} = \frac{z - z_0}{z'(t_0)}$$
                    </div>
                    
                    <p>其中切线的<strong>方向向量</strong>为：$\vec{T} = \vec{r}'(t_0) = (x'(t_0), y'(t_0), z'(t_0))$</p>
                </div>
                
                <div class="theorem">
                    <h4>空间曲线的法平面方程</h4>
                    <p>过点 $M_0(x_0, y_0, z_0)$ 且垂直于切线的平面称为<strong>法平面</strong>，其方程为：</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">法平面方程</div>
                        $$x'(t_0)(x - x_0) + y'(t_0)(y - y_0) + z'(t_0)(z - z_0) = 0$$
                    </div>
                    
                    <p>法平面的<strong>法向量</strong>就是切线的方向向量：$\vec{n} = (x'(t_0), y'(t_0), z'(t_0))$</p>
                </div>
                
                <div class="highlight">
                    <p><strong>特殊情况：</strong>当曲线由两个方程确定时：$F(x,y,z) = 0$ 和 $G(x,y,z) = 0$，切线的方向向量为：</p>
                    $$\vec{T} = \nabla F \times \nabla G$$
                </div>
                
                <div class="visualization-container">
                    <div class="viz-header">
                        空间曲线的切线与法平面可视化
                    </div>
                    <div class="viz-content">
                        <div class="viz-controls">
                            <div class="control-group">
                                <label for="t-param">参数 t:</label>
                                <input type="range" id="t-param" min="0" max="6.28" step="0.1" value="1.57">
                                <span id="t-value">1.57</span>
                            </div>
                        </div>
                        <div id="curve-tangent-plot"></div>
                    </div>
                </div>
                
                <div class="example">
                    <h4>例1：求螺旋线的切线和法平面</h4>
                    <p>求螺旋线 $\vec{r}(t) = a\cos t\vec{i} + a\sin t\vec{j} + bt\vec{k}$ 在 $t = \frac{\pi}{4}$ 处的切线方程和法平面方程。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p><strong>步骤1：</strong>求对应点的坐标</p>
                        <p>当 $t = \frac{\pi}{4}$ 时：</p>
                        $$x_0 = a\cos\frac{\pi}{4} = \frac{a\sqrt{2}}{2}, \quad y_0 = a\sin\frac{\pi}{4} = \frac{a\sqrt{2}}{2}, \quad z_0 = b\frac{\pi}{4}$$
                        
                        <p><strong>步骤2：</strong>求切向量</p>
                        $$\vec{r}'(t) = -a\sin t\vec{i} + a\cos t\vec{j} + b\vec{k}$$
                        $$\vec{r}'\left(\frac{\pi}{4}\right) = -\frac{a\sqrt{2}}{2}\vec{i} + \frac{a\sqrt{2}}{2}\vec{j} + b\vec{k}$$
                        
                        <p><strong>步骤3：</strong>写出切线方程</p>
                        $$\frac{x - \frac{a\sqrt{2}}{2}}{-\frac{a\sqrt{2}}{2}} = \frac{y - \frac{a\sqrt{2}}{2}}{\frac{a\sqrt{2}}{2}} = \frac{z - \frac{b\pi}{4}}{b}$$
                        
                        <p><strong>步骤4：</strong>写出法平面方程</p>
                        $$-\frac{a\sqrt{2}}{2}\left(x - \frac{a\sqrt{2}}{2}\right) + \frac{a\sqrt{2}}{2}\left(y - \frac{a\sqrt{2}}{2}\right) + b\left(z - \frac{b\pi}{4}\right) = 0$$
                    </div>
                </div>
                
                <div class="example">
                    <h4>例2：两方程确定的曲线</h4>
                    <p>求由方程组 $\begin{cases} x^2 + y^2 + z^2 = 6 \\ x + y + z = 0 \end{cases}$ 确定的曲线在点 $(1, -2, 1)$ 处的切线方程。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p>设 $F(x,y,z) = x^2 + y^2 + z^2 - 6$，$G(x,y,z) = x + y + z$</p>
                        
                        <p><strong>步骤1：</strong>求梯度</p>
                        $$\nabla F = (2x, 2y, 2z), \quad \nabla G = (1, 1, 1)$$
                        
                        <p>在点 $(1, -2, 1)$ 处：</p>
                        $$\nabla F|_{(1,-2,1)} = (2, -4, 2), \quad \nabla G|_{(1,-2,1)} = (1, 1, 1)$$
                        
                        <p><strong>步骤2：</strong>求切向量</p>
                        $$\vec{T} = \nabla F \times \nabla G = \begin{vmatrix}
                        \vec{i} & \vec{j} & \vec{k} \\
                        2 & -4 & 2 \\
                        1 & 1 & 1
                        \end{vmatrix} = (-6, 0, 6)$$
                        
                        <p>简化为 $(-1, 0, 1)$</p>
                        
                        <p><strong>步骤3：</strong>写出切线方程</p>
                        $$\frac{x - 1}{-1} = \frac{y + 2}{0} = \frac{z - 1}{1}$$
                        <p>即：$x + z = 2$ 且 $y = -2$</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 9.6.3 曲面的切平面与法线；法线的方向余弦 -->
        <div class="content-section">
            <div class="section-header">
                <h2>9.6.3 曲面的切平面与法线；法线的方向余弦</h2>
            </div>
            <div class="section-content">
                <div class="definition">
                    <h4>曲面方程的形式</h4>
                    <p>曲面 $S$ 可以用以下形式表示：</p>
                    <ul>
                        <li><strong>隐式方程：</strong>$F(x, y, z) = 0$</li>
                        <li><strong>显式方程：</strong>$z = f(x, y)$</li>
                        <li><strong>参数方程：</strong>$\vec{r}(u, v) = x(u,v)\vec{i} + y(u,v)\vec{j} + z(u,v)\vec{k}$</li>
                    </ul>
                </div>
                
                <div class="theorem">
                    <h4>隐式曲面的切平面与法线</h4>
                    <p>设曲面 $S$ 的方程为 $F(x, y, z) = 0$，点 $M_0(x_0, y_0, z_0)$ 为曲面上一点，且 $\nabla F|_{M_0} \neq \vec{0}$，则：</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">切平面方程</div>
                        $$F_x(x_0, y_0, z_0)(x - x_0) + F_y(x_0, y_0, z_0)(y - y_0) + F_z(x_0, y_0, z_0)(z - z_0) = 0$$
                    </div>
                    
                    <div class="formula-box">
                        <div class="formula-title">法线方程</div>
                        $$\frac{x - x_0}{F_x(x_0, y_0, z_0)} = \frac{y - y_0}{F_y(x_0, y_0, z_0)} = \frac{z - z_0}{F_z(x_0, y_0, z_0)}$$
                    </div>
                    
                    <p><strong>法向量：</strong>$\vec{n} = \nabla F|_{M_0} = (F_x, F_y, F_z)|_{M_0}$</p>
                </div>
                
                <div class="theorem">
                    <h4>显式曲面的切平面与法线</h4>
                    <p>设曲面 $S$ 的方程为 $z = f(x, y)$，点 $M_0(x_0, y_0, z_0)$ 为曲面上一点，则：</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">切平面方程</div>
                        $$z - z_0 = f_x(x_0, y_0)(x - x_0) + f_y(x_0, y_0)(y - y_0)$$
                    </div>
                    
                    <div class="formula-box">
                        <div class="formula-title">法线方程</div>
                        $$\frac{x - x_0}{f_x(x_0, y_0)} = \frac{y - y_0}{f_y(x_0, y_0)} = \frac{z - z_0}{-1}$$
                    </div>
                    
                    <p><strong>法向量：</strong>$\vec{n} = (f_x, f_y, -1)|_{M_0}$</p>
                </div>
                
                <div class="definition">
                    <h4>法线的方向余弦</h4>
                    <p>设曲面的法向量为 $\vec{n} = (A, B, C)$，则法线的<strong>方向余弦</strong>为：</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">方向余弦</div>
                        $$\cos\alpha = \frac{A}{\sqrt{A^2 + B^2 + C^2}}, \quad \cos\beta = \frac{B}{\sqrt{A^2 + B^2 + C^2}}, \quad \cos\gamma = \frac{C}{\sqrt{A^2 + B^2 + C^2}}$$
                    </div>
                    
                    <p>其中 $\alpha$、$\beta$、$\gamma$ 分别是法线与 $x$、$y$、$z$ 轴的夹角。</p>
                </div>
                
                <div class="visualization-container">
                    <div class="viz-header">
                        曲面的切平面与法线可视化
                    </div>
                    <div class="viz-content">
                        <div class="viz-controls">
                            <div class="control-group">
                                <label for="surface-type">曲面类型:</label>
                                <select id="surface-type">
                                    <option value="paraboloid">抛物面 z = x² + y²</option>
                                    <option value="saddle">马鞍面 z = x² - y²</option>
                                    <option value="ellipsoid">椭球面</option>
                                </select>
                            </div>
                            <div class="control-group">
                                <label for="point-x">点 x 坐标:</label>
                                <input type="range" id="point-x" min="-1.5" max="1.5" step="0.1" value="1.0">
                                <span id="x-value">1.0</span>
                            </div>
                            <div class="control-group">
                                <label for="point-y">点 y 坐标:</label>
                                <input type="range" id="point-y" min="-1.5" max="1.5" step="0.1" value="0.5">
                                <span id="y-value">0.5</span>
                            </div>
                        </div>
                        <div id="surface-tangent-plot"></div>
                    </div>
                </div>
                
                <div class="example">
                    <h4>例1：椭球面的切平面与法线</h4>
                    <p>求椭球面 $\frac{x^2}{4} + \frac{y^2}{9} + z^2 = 1$ 在点 $(1, 3, -\frac{1}{2})$ 处的切平面方程和法线方程。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p>设 $F(x, y, z) = \frac{x^2}{4} + \frac{y^2}{9} + z^2 - 1$</p>
                        
                        <p><strong>步骤1：</strong>求偏导数</p>
                        $$F_x = \frac{x}{2}, \quad F_y = \frac{2y}{9}, \quad F_z = 2z$$
                        
                        <p>在点 $(1, 3, -\frac{1}{2})$ 处：</p>
                        $$F_x = \frac{1}{2}, \quad F_y = \frac{2 \cdot 3}{9} = \frac{2}{3}, \quad F_z = 2 \cdot \left(-\frac{1}{2}\right) = -1$$
                        
                        <p><strong>步骤2：</strong>写出切平面方程</p>
                        $$\frac{1}{2}(x - 1) + \frac{2}{3}(y - 3) + (-1)\left(z + \frac{1}{2}\right) = 0$$
                        <p>整理得：$3x + 4y - 6z = 18$</p>
                        
                        <p><strong>步骤3：</strong>写出法线方程</p>
                        $$\frac{x - 1}{\frac{1}{2}} = \frac{y - 3}{\frac{2}{3}} = \frac{z + \frac{1}{2}}{-1}$$
                        <p>即：$\frac{x - 1}{3} = \frac{y - 3}{4} = \frac{z + \frac{1}{2}}{-6}$</p>
                    </div>
                </div>
                
                <div class="example">
                    <h4>例2：抛物面的切平面</h4>
                    <p>求抛物面 $z = x^2 + y^2$ 在点 $(1, 2, 5)$ 处的切平面方程，并求法线的方向余弦。</p>
                    
                    <div class="solution">
                        <div class="solution-header">解：</div>
                        <p>设 $f(x, y) = x^2 + y^2$</p>
                        
                        <p><strong>步骤1：</strong>求偏导数</p>
                        $$f_x = 2x, \quad f_y = 2y$$
                        
                        <p>在点 $(1, 2, 5)$ 处：</p>
                        $$f_x(1, 2) = 2, \quad f_y(1, 2) = 4$$
                        
                        <p><strong>步骤2：</strong>写出切平面方程</p>
                        $$z - 5 = 2(x - 1) + 4(y - 2)$$
                        <p>即：$2x + 4y - z = 5$</p>
                        
                        <p><strong>步骤3：</strong>求法线方向余弦</p>
                        <p>法向量：$\vec{n} = (2, 4, -1)$</p>
                        <p>$|\vec{n}| = \sqrt{4 + 16 + 1} = \sqrt{21}$</p>
                        
                        <p>方向余弦：</p>
                        $$\cos\alpha = \frac{2}{\sqrt{21}}, \quad \cos\beta = \frac{4}{\sqrt{21}}, \quad \cos\gamma = \frac{-1}{\sqrt{21}}$$
                    </div>
                </div>
            </div>
        </div>
        
        <div class="nav-buttons">
            <a href="9.5.html" class="btn prev">上一节：9.5 隐函数的求导公式</a>
            <a href="9.7.html" class="btn next">下一节：9.7 方向导数与梯度</a>
        </div>

        <footer>
            <p>&copy; 2025 高等数学复习系统 - 多元函数微分学的几何应用</p>
        </footer>
    </div>

    <script>
        // 等待页面加载完成
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化可视化
            initCurveTangentVisualization();
            initSurfaceTangentVisualization();
            
            // 添加控件事件监听器
            document.getElementById('t-param').addEventListener('input', updateVisualization);
            document.getElementById('surface-type').addEventListener('change', updateSurfaceVisualization);
            document.getElementById('point-x').addEventListener('input', updateSurfaceVisualization);
            document.getElementById('point-y').addEventListener('input', updateSurfaceVisualization);
        });

        function initCurveTangentVisualization() {
            createCurveTangentPlot(1.57, 'wave');
        }

        function updateVisualization() {
            const t = parseFloat(document.getElementById('t-param').value);
            
            // 更新参数值显示
            document.getElementById('t-value').textContent = t.toFixed(2);
            
            createCurveTangentPlot(t, 'wave');
        }

        function createCurveTangentPlot(t0, curveType) {
            // 波浪曲线参数化函数
            function getCurvePoint(t) {
                return {
                    x: t,
                    y: 2 * Math.sin(t),
                    z: Math.cos(t)
                };
            }

            // 波浪曲线导数函数
            function getCurveDerivative(t) {
                return {
                    x: 1,
                    y: 2 * Math.cos(t),
                    z: -Math.sin(t)
                };
            }

            // 生成曲线数据
            const tValues = [];
            const xCurve = [], yCurve = [], zCurve = [];
            
            for (let t = 0; t <= 2 * Math.PI; t += 0.1) {
                const point = getCurvePoint(t);
                tValues.push(t);
                xCurve.push(point.x);
                yCurve.push(point.y);
                zCurve.push(point.z);
            }

            // 当前点和切向量
            const currentPoint = getCurvePoint(t0);
            const tangentVector = getCurveDerivative(t0);

            // 切线数据
            const tangentLineLength = 2;
            const tangentStart = {
                x: currentPoint.x - tangentLineLength * tangentVector.x,
                y: currentPoint.y - tangentLineLength * tangentVector.y,
                z: currentPoint.z - tangentLineLength * tangentVector.z
            };
            const tangentEnd = {
                x: currentPoint.x + tangentLineLength * tangentVector.x,
                y: currentPoint.y + tangentLineLength * tangentVector.y,
                z: currentPoint.z + tangentLineLength * tangentVector.z
            };

            // 法平面数据 - 使用点法式方程：ax + by + cz = d
            const planeSize = 2.0;
            const planeX = [], planeY = [], planeZ = [];
            
            // 法平面的法向量就是切向量 (a, b, c)
            const a = tangentVector.x;
            const b = tangentVector.y;
            const c = tangentVector.z;
            const d = a * currentPoint.x + b * currentPoint.y + c * currentPoint.z;
            
            console.log(`法平面方程: ${a.toFixed(3)}x + ${b.toFixed(3)}y + ${c.toFixed(3)}z = ${d.toFixed(3)}`);
            console.log(`切向量: (${a.toFixed(3)}, ${b.toFixed(3)}, ${c.toFixed(3)})`);
            console.log(`当前点: (${currentPoint.x.toFixed(3)}, ${currentPoint.y.toFixed(3)}, ${currentPoint.z.toFixed(3)})`);
            
            // 生成法平面网格点 - 选择最稳定的求解方向
            const gridSize = 8;
            const absA = Math.abs(a);
            const absB = Math.abs(b);
            const absC = Math.abs(c);
            
            // 选择绝对值最大的系数作为求解变量，提高数值稳定性
            if (absC >= absA && absC >= absB) {
                // 用z求解: z = (d - ax - by) / c
                for (let i = 0; i < gridSize; i++) {
                    const rowX = [], rowY = [], rowZ = [];
                    for (let j = 0; j < gridSize; j++) {
                        const x = currentPoint.x + planeSize * (i / (gridSize - 1) - 0.5);
                        const y = currentPoint.y + planeSize * (j / (gridSize - 1) - 0.5);
                        const z = (d - a * x - b * y) / c;
                        
                        rowX.push(x);
                        rowY.push(y);
                        rowZ.push(z);
                    }
                    planeX.push(rowX);
                    planeY.push(rowY);
                    planeZ.push(rowZ);
                }
            } else if (absB >= absA && absB >= absC) {
                // 用y求解: y = (d - ax - cz) / b
                for (let i = 0; i < gridSize; i++) {
                    const rowX = [], rowY = [], rowZ = [];
                    for (let j = 0; j < gridSize; j++) {
                        const x = currentPoint.x + planeSize * (i / (gridSize - 1) - 0.5);
                        const z = currentPoint.z + planeSize * (j / (gridSize - 1) - 0.5);
                        const y = (d - a * x - c * z) / b;
                        
                        rowX.push(x);
                        rowY.push(y);
                        rowZ.push(z);
                    }
                    planeX.push(rowX);
                    planeY.push(rowY);
                    planeZ.push(rowZ);
                }
            } else {
                // 用x求解: x = (d - by - cz) / a
                for (let i = 0; i < gridSize; i++) {
                    const rowX = [], rowY = [], rowZ = [];
                    for (let j = 0; j < gridSize; j++) {
                        const y = currentPoint.y + planeSize * (i / (gridSize - 1) - 0.5);
                        const z = currentPoint.z + planeSize * (j / (gridSize - 1) - 0.5);
                        const x = (d - b * y - c * z) / a;
                        
                        rowX.push(x);
                        rowY.push(y);
                        rowZ.push(z);
                    }
                    planeX.push(rowX);
                    planeY.push(rowY);
                    planeZ.push(rowZ);
                }
            }
            
            // 验证法平面上的点是否满足方程
            console.log("验证法平面上的点:");
            for (let i = 0; i < Math.min(3, gridSize); i++) {
                for (let j = 0; j < Math.min(3, gridSize); j++) {
                    const px = planeX[i][j];
                    const py = planeY[i][j]; 
                    const pz = planeZ[i][j];
                    const result = a * px + b * py + c * pz;
                    const error = Math.abs(result - d);
                    console.log(`点(${px.toFixed(3)}, ${py.toFixed(3)}, ${pz.toFixed(3)}): ${a.toFixed(3)}*${px.toFixed(3)} + ${b.toFixed(3)}*${py.toFixed(3)} + ${c.toFixed(3)}*${pz.toFixed(3)} = ${result.toFixed(6)}, 误差 = ${error.toFixed(8)}`);
                }
            }

            // 创建Plotly图形
            const data = [
                // 空间曲线
                {
                    x: xCurve,
                    y: yCurve,
                    z: zCurve,
                    type: 'scatter3d',
                    mode: 'lines',
                    line: {
                        color: '#8a2be2',
                        width: 6
                    },
                    name: '空间曲线'
                },
                // 当前点
                {
                    x: [currentPoint.x],
                    y: [currentPoint.y],
                    z: [currentPoint.z],
                    type: 'scatter3d',
                    mode: 'markers',
                    marker: {
                        color: '#ff4444',
                        size: 8
                    },
                    name: '当前点'
                },
                // 切线
                {
                    x: [tangentStart.x, tangentEnd.x],
                    y: [tangentStart.y, tangentEnd.y],
                    z: [tangentStart.z, tangentEnd.z],
                    type: 'scatter3d',
                    mode: 'lines',
                    line: {
                        color: '#ff6600',
                        width: 8
                    },
                    name: '切线'
                },
                // 法平面
                {
                    x: planeX,
                    y: planeY,
                    z: planeZ,
                    type: 'surface',
                    opacity: 0.3,
                    colorscale: [[0, '#e8e2ff'], [1, '#ba7fdb']],
                    showscale: false,
                    name: '法平面'
                }
            ];

            const layout = {
                scene: {
                    xaxis: {
                        title: 'X',
                        range: [0, 6.5]
                    },
                    yaxis: {
                        title: 'Y', 
                        range: [-2.5, 2.5]
                    },
                    zaxis: {
                        title: 'Z',
                        range: [-1.5, 1.5]
                    },
                    camera: {
                        eye: {x: 1.5, y: 1.5, z: 1.5}
                    },
                    aspectmode: 'manual',
                    aspectratio: {x: 2, y: 1, z: 0.6}
                },
                margin: {l: 0, r: 0, t: 0, b: 0},
                showlegend: true,
                legend: {
                    x: 0,
                    y: 1,
                    bgcolor: 'rgba(255,255,255,0.8)'
                }
            };

            const config = {
                displayModeBar: true,
                modeBarButtonsToRemove: ['pan2d', 'select2d', 'lasso2d', 'autoScale2d'],
                responsive: true
            };

            Plotly.newPlot('curve-tangent-plot', data, layout, config);
        }

        function initSurfaceTangentVisualization() {
            createSurfaceTangentPlot('paraboloid', 1.0, 0.5);
        }

        function updateSurfaceVisualization() {
            const surfaceType = document.getElementById('surface-type').value;
            const x = parseFloat(document.getElementById('point-x').value);
            const y = parseFloat(document.getElementById('point-y').value);
            
            // 更新参数值显示
            document.getElementById('x-value').textContent = x.toFixed(1);
            document.getElementById('y-value').textContent = y.toFixed(1);
            
            createSurfaceTangentPlot(surfaceType, x, y);
        }

        function createSurfaceTangentPlot(surfaceType, px, py) {
            // 定义不同类型的曲面函数
            function getSurfaceFunction(type) {
                switch(type) {
                    case 'paraboloid':
                        return {
                            f: (x, y) => x*x + y*y,
                            fx: (x, y) => 2*x,
                            fy: (x, y) => 2*y,
                            name: '抛物面 z = x² + y²'
                        };
                    case 'saddle':
                        return {
                            f: (x, y) => x*x - y*y,
                            fx: (x, y) => 2*x,
                            fy: (x, y) => -2*y,
                            name: '马鞍面 z = x² - y²'
                        };
                    case 'ellipsoid':
                        return {
                            f: (x, y) => Math.sqrt(Math.max(0, 4 - x*x - y*y)),
                            fx: (x, y) => -x / Math.sqrt(Math.max(0.001, 4 - x*x - y*y)),
                            fy: (x, y) => -y / Math.sqrt(Math.max(0.001, 4 - x*x - y*y)),
                            name: '椭球面 x² + y² + z² = 4 (上半部分)'
                        };
                    default:
                        return getSurfaceFunction('paraboloid');
                }
            }

            const surface = getSurfaceFunction(surfaceType);
            
            // 生成曲面数据
            const range = surfaceType === 'ellipsoid' ? 1.8 : 2.0;
            const gridSize = 30;
            const xSurface = [], ySurface = [], zSurface = [];
            
            for (let i = 0; i < gridSize; i++) {
                const xRow = [], yRow = [], zRow = [];
                for (let j = 0; j < gridSize; j++) {
                    const x = -range + (2 * range * i) / (gridSize - 1);
                    const y = -range + (2 * range * j) / (gridSize - 1);
                    
                    let z;
                    if (surfaceType === 'ellipsoid' && x*x + y*y >= 4) {
                        z = 0; // 椭球面边界外设为0
                    } else {
                        z = surface.f(x, y);
                    }
                    
                    xRow.push(x);
                    yRow.push(y);
                    zRow.push(z);
                }
                xSurface.push(xRow);
                ySurface.push(yRow);
                zSurface.push(zRow);
            }
            
            // 计算指定点的信息
            const pz = surface.f(px, py);
            const fx = surface.fx(px, py);
            const fy = surface.fy(px, py);
            
            console.log(`曲面点: (${px.toFixed(3)}, ${py.toFixed(3)}, ${pz.toFixed(3)})`);
            console.log(`偏导数: fx = ${fx.toFixed(3)}, fy = ${fy.toFixed(3)}`);
            console.log(`法向量: (${fx.toFixed(3)}, ${fy.toFixed(3)}, -1)`);
            
            // 生成切平面
            const planeSize = 1.5;
            const planeGrid = 6;
            const xPlane = [], yPlane = [], zPlane = [];
            
            for (let i = 0; i < planeGrid; i++) {
                const xRow = [], yRow = [], zRow = [];
                for (let j = 0; j < planeGrid; j++) {
                    const x = px + planeSize * (i / (planeGrid - 1) - 0.5);
                    const y = py + planeSize * (j / (planeGrid - 1) - 0.5);
                    // 切平面方程: z - pz = fx(x - px) + fy(y - py)
                    const z = pz + fx * (x - px) + fy * (y - py);
                    
                    xRow.push(x);
                    yRow.push(y);
                    zRow.push(z);
                }
                xPlane.push(xRow);
                yPlane.push(yRow);
                zPlane.push(zRow);
            }
            
            // 生成法线
            const normalLength = 1.0;
            const normalVector = {
                x: fx,
                y: fy,
                z: -1
            };
            // 标准化法向量
            const normalMagnitude = Math.sqrt(normalVector.x * normalVector.x + normalVector.y * normalVector.y + normalVector.z * normalVector.z);
            normalVector.x /= normalMagnitude;
            normalVector.y /= normalMagnitude;
            normalVector.z /= normalMagnitude;
            
            const normalStart = {
                x: px - normalLength * normalVector.x,
                y: py - normalLength * normalVector.y,
                z: pz - normalLength * normalVector.z
            };
            const normalEnd = {
                x: px + normalLength * normalVector.x,
                y: py + normalLength * normalVector.y,
                z: pz + normalLength * normalVector.z
            };

            // 创建Plotly图形
            const data = [
                // 曲面
                {
                    x: xSurface,
                    y: ySurface,
                    z: zSurface,
                    type: 'surface',
                    opacity: 0.7,
                    colorscale: 'Viridis',
                    showscale: true,
                    name: surface.name,
                    colorbar: {
                        title: 'z值',
                        titleside: 'right',
                        len: 0.6,
                        thickness: 15
                    }
                },
                // 指定点
                {
                    x: [px],
                    y: [py],
                    z: [pz],
                    type: 'scatter3d',
                    mode: 'markers',
                    marker: {
                        color: '#ff4444',
                        size: 10
                    },
                    name: '指定点'
                },
                // 切平面
                {
                    x: xPlane,
                    y: yPlane,
                    z: zPlane,
                    type: 'surface',
                    opacity: 0.4,
                    colorscale: [[0, '#ffcccb'], [1, '#ff6b6b']],
                    showscale: false,
                    name: '切平面'
                },
                // 法线
                {
                    x: [normalStart.x, normalEnd.x],
                    y: [normalStart.y, normalEnd.y],
                    z: [normalStart.z, normalEnd.z],
                    type: 'scatter3d',
                    mode: 'lines',
                    line: {
                        color: '#0066cc',
                        width: 8
                    },
                    name: '法线'
                }
            ];

            const layout = {
                scene: {
                    xaxis: {
                        title: 'X',
                        range: [-2.5, 2.5]
                    },
                    yaxis: {
                        title: 'Y',
                        range: [-2.5, 2.5]
                    },
                    zaxis: {
                        title: 'Z',
                        range: surfaceType === 'saddle' ? [-3, 3] : [-0.5, 4]
                    },
                    camera: {
                        eye: {x: 1.8, y: 1.8, z: 1.2}
                    },
                    aspectmode: 'manual',
                    aspectratio: {x: 1, y: 1, z: 0.8}
                },
                margin: {l: 0, r: 0, t: 0, b: 0},
                showlegend: true,
                legend: {
                    x: 0,
                    y: 1,
                    bgcolor: 'rgba(255,255,255,0.8)'
                }
            };

            const config = {
                displayModeBar: true,
                modeBarButtonsToRemove: ['pan2d', 'select2d', 'lasso2d', 'autoScale2d'],
                responsive: true
            };

            Plotly.newPlot('surface-tangent-plot', data, layout, config);
        }
    </script>
</body>
</html>
