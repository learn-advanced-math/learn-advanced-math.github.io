<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="alternate icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTUiIGZpbGw9IiMzNDk4ZGIiIHN0cm9rZT0iIzJjM2U1MCIgc3Ryb2tlLXdpZHRoPSIyIi8+PGcgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPjx0ZXh0IHg9IjE2IiB5PSIxMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMiI+ZDwvdGV4dD48bGluZSB4MT0iOCIgeTE9IjE2IiB4Mj0iMjQiIHkyPSIxNiIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIxLjUiLz48dGV4dCB4PSIxNiIgeT0iMjUiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTAiPmR4PC90ZXh0PjwvZz48L3N2Zz4=">
    <title>11.3 格林公式及其应用 - 高等数学复习</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            },
            chtml: {
                fontURL: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            margin-bottom: 20px;
            color: #2ecc71;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 15px;
            border-radius: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .back-link:hover {
            color: #27ae60;
            transform: translateX(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        
        .back-link::before {
            content: '←';
            margin-right: 8px;
            font-size: 1.2em;
        }
        
        header {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            font-weight: 300;
        }
        
        .subtitle {
            font-size: 1.1em;
            margin-top: 10px;
            opacity: 0.9;
        }
        
        .content-section {
            background: white;
            margin: 25px 0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .content-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .section-header {
            padding: 20px 30px;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
        }
        
        .section-header h2 {
            margin: 0;
            font-size: 1.6em;
            font-weight: 400;
        }
        
        .section-content {
            padding: 30px;
        }
        
        .definition {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            border-left: 5px solid #27ae60;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(39, 174, 96, 0.1);
        }
        
        .definition h4 {
            margin: 0 0 15px 0;
            color: #27ae60;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .theorem {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border-left: 5px solid #ff9800;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(255, 152, 0, 0.1);
        }
        
        .theorem h4 {
            margin: 0 0 15px 0;
            color: #ff9800;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .example {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 5px solid #2196f3;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(33, 150, 243, 0.1);
        }
        
        .example h4 {
            margin: 0 0 15px 0;
            color: #2196f3;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .important-box {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border-left: 5px solid #f44336;
            padding: 25px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(244, 67, 54, 0.1);
        }
        
        .important-box h4 {
            margin: 0 0 15px 0;
            color: #f44336;
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .application-box {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            border-left: 5px solid #9c27b0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            box-shadow: 0 3px 15px rgba(156, 39, 176, 0.1);
        }
        
        .application-box h4 {
            margin: 0 0 15px 0;
            color: #9c27b0;
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .formula-card {
            background: white;
            border: 2px solid #27ae60;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 3px 15px rgba(39, 174, 96, 0.1);
        }
        
        .formula-card h5 {
            color: #27ae60;
            margin: 0 0 10px 0;
            font-size: 1.1em;
        }
        
        .visualization-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            margin: 20px 0;
        }
        
        .viz-header {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            padding: 15px 20px;
            text-align: center;
        }
        
        .viz-header h4 {
            margin: 0;
            font-size: 1.2em;
            font-weight: 400;
        }
        
        .viz-controls {
            padding: 15px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        
        .viz-control-group {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .viz-control-group label {
            font-weight: 500;
            color: #2c3e50;
            min-width: 80px;
        }
        
        .viz-control-group input[type="range"] {
            flex: 1;
            min-width: 150px;
        }
        
        .viz-control-group span {
            font-weight: bold;
            color: #27ae60;
            min-width: 30px;
        }
        
        .viz-control-group button {
            padding: 5px 15px;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .viz-control-group button:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(39, 174, 96, 0.3);
        }
        
        #green-visualization {
            display: block;
            width: 100%;
            height: 450px;
            background: white;
            border: 1px solid #ddd;
        }
        
        .vector-arrow {
            fill: none;
            stroke: #3498db;
            stroke-width: 1.5;
            marker-end: url(#vector-arrowhead);
        }
        
        .boundary-arrow {
            fill: none;
            stroke: #e74c3c;
            stroke-width: 2;
            marker-end: url(#boundary-arrowhead);
        }
        
        .region-circle {
            fill: rgba(46, 204, 113, 0.2);
            stroke: #27ae60;
            stroke-width: 3;
        }
        
        .grid-line {
            stroke: #ddd;
            stroke-width: 1;
        }
        
        .axis {
            stroke: #999;
            stroke-width: 2;
        }
        
        .axis-label {
            font-size: 14px;
            fill: #2c3e50;
            text-anchor: middle;
        }
        
        .explanation-text {
            font-size: 12px;
            fill: #2c3e50;
        }
        
        .highlight {
            background: linear-gradient(135deg, #fff3cd, #fce4a0);
            padding: 15px;
            border-left: 4px solid #ffc107;
            border-radius: 0 8px 8px 0;
            margin: 15px 0;
        }
        
        .conditions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .condition-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #6c757d;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .condition-card h5 {
            color: #495057;
            margin-bottom: 10px;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding: 20px 0;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 25px;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 3px 15px rgba(39, 174, 96, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(39, 174, 96, 0.4);
        }
        
        .btn.prev::before {
            content: '←';
            margin-right: 8px;
            font-size: 1.1em;
        }
        
        .btn.next::after {
            content: '→';
            margin-left: 8px;
            font-size: 1.1em;
        }
        
        footer {
            text-align: center;
            color: white;
            padding: 30px 0;
            opacity: 0.9;
            margin-top: 50px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        footer p {
            text-align: center;
            margin: 0;
        }
        
        .math-expression {
            text-align: center;
            margin: 15px 0;
            font-size: 1.1em;
        }
        
        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        .step-by-step {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .step-by-step h5 {
            color: #495057;
            margin-bottom: 10px;
        }

        /* AI提示方块样式 */
        .ai-warning {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            border: 2px solid #e0e0e0;
        }
        
        .ai-warning:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            border-color: #ff4444;
        }
        
        .ai-warning::before {
            content: '!';
            color: #e74c3c;
            font-size: 20px;
            font-weight: bold;
            font-family: Arial, sans-serif;
        }
        
        .ai-warning-tooltip {
            position: absolute;
            top: 50px;
            left: 0;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 16px 20px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
            width: 250px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .ai-warning-tooltip::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid rgba(0, 0, 0, 0.9);
        }
        
        .ai-warning:hover .ai-warning-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .definition, .theorem, .example {
                padding: 20px;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .conditions-grid {
                grid-template-columns: 1fr;
            }

            .ai-warning {
                width: 35px;
                height: 35px;
                top: 15px;
                left: 15px;
            }
            
            .ai-warning::before {
                font-size: 18px;
            }
            
            .ai-warning-tooltip {
                width: 280px;
                font-size: 13px;
                padding: 14px 18px;
            }
        }
    </style>
</head>
<body>
    <!-- AI内容提示 -->
    <div class="ai-warning">
        <div class="ai-warning-tooltip">
            页面内容由AI生成，请谨慎对待。<br>如发现错误，欢迎反馈。
        </div>
    </div>
    
    <div class="container">
        <a href="../index.html" class="back-link">返回章节概览</a>
        
        <header>
            <h1>11.3 格林公式及其应用</h1>
            <div class="subtitle">Green's Formula and Its Applications</div>
        </header>
        
        <!-- 11.3.1 格林公式 -->
        <div class="content-section">
            <div class="section-header">
                <h2>11.3.1 格林公式</h2>
            </div>
            <div class="section-content">
                <div class="theorem">
                    <h4>格林公式（Green's Formula）</h4>
                    <p>设闭区域 $D$ 由分段光滑的简单闭曲线 $L$ 围成，函数 $P(x,y)$ 及 $Q(x,y)$ 在 $D$ 上具有一阶连续偏导数，则有：</p>
                    
                    <div class="math-expression">
                        $$\oint_L P \, dx + Q \, dy = \iint_D \left(\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}\right) \, dx \, dy$$
                    </div>
                    
                    <p>其中 $L$ 是 $D$ 的边界曲线的正方向（逆时针方向）。</p>
                    
                    <div class="highlight">
                        <p><strong>几何意义：</strong>格林公式建立了平面闭区域上的二重积分与其边界曲线上的曲线积分之间的关系。它是微积分基本定理在二维情况下的推广。</p>
                    </div>
                </div>
                
                <div class="important-box">
                    <h4>格林公式的条件</h4>
                    <ol>
                        <li><strong>区域条件：</strong>$D$ 是由简单闭曲线围成的闭区域</li>
                        <li><strong>函数条件：</strong>$P(x,y)$ 和 $Q(x,y)$ 在 $D$ 上具有一阶连续偏导数</li>
                        <li><strong>曲线条件：</strong>边界曲线 $L$ 分段光滑，取正方向（逆时针）</li>
                    </ol>
                    
                    <p><strong>注意：</strong>如果区域 $D$ 不是单连通的（有洞），需要对每个边界分别应用公式。</p>
                </div>
                
                <div class="visualization-container">
                    <div class="viz-header">
                        <h4>格林公式可视化演示 - 圆形区域（逆时针正方向）</h4>
                    </div>
                    <div class="viz-controls">
                        <div class="viz-control-group">
                            <span style="color: #2c3e50; font-weight: 500;">向量场：F = (-y, x)，区域边界取逆时针正方向</span>
                        </div>
                    </div>
                    <div id="green-visualization" style="width: 100%; height: 450px; background: white; margin: 0 auto; display: flex; justify-content: center; align-items: center;"></div>
                </div>
                
                <div class="example">
                    <h4>例1：应用格林公式计算曲线积分</h4>
                    <p>计算 $\oint_L (x^2 - y^2) \, dx + 2xy \, dy$，其中 $L$ 是由曲线 $y = x^2$ 和直线 $y = x$ 围成的区域的边界（正方向）。</p>
                    
                    <div class="step-by-step">
                        <h5>解题步骤：</h5>
                        <p><strong>步骤1：</strong>确定 $P(x,y) = x^2 - y^2$，$Q(x,y) = 2xy$</p>
                        <p><strong>步骤2：</strong>计算偏导数</p>
                        $$\frac{\partial Q}{\partial x} = 2y, \quad \frac{\partial P}{\partial y} = -2y$$
                        <p><strong>步骤3：</strong>应用格林公式</p>
                        $$\oint_L (x^2 - y^2) \, dx + 2xy \, dy = \iint_D (2y - (-2y)) \, dx \, dy = \iint_D 4y \, dx \, dy$$
                        <p><strong>步骤4：</strong>确定积分区域 $D$：$x^2 \leq y \leq x$，$0 \leq x \leq 1$</p>
                        <p><strong>步骤5：</strong>计算二重积分</p>
                        $$\iint_D 4y \, dx \, dy = \int_0^1 \int_{x^2}^x 4y \, dy \, dx = \int_0^1 [2y^2]_{x^2}^x \, dx$$
                        $$= \int_0^1 (2x^2 - 2x^4) \, dx = \left[\frac{2x^3}{3} - \frac{2x^5}{5}\right]_0^1 = \frac{2}{3} - \frac{2}{5} = \frac{4}{15}$$
                    </div>
                </div>
                
                <div class="example">
                    <h4>例2：计算区域面积</h4>
                    <p>利用格林公式计算椭圆 $\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1$ 所围成区域的面积。</p>
                    
                    <div class="step-by-step">
                        <h5>解题思路：</h5>
                        <p>利用公式：$\text{面积} = \iint_D dx \, dy = \frac{1}{2} \oint_L x \, dy - y \, dx$</p>
                        <p>椭圆的参数方程：$x = a\cos t$，$y = b\sin t$，$t$ 从 $0$ 到 $2\pi$</p>
                        <p>$dx = -a\sin t \, dt$，$dy = b\cos t \, dt$</p>
                        <p>因此：</p>
                        $$\text{面积} = \frac{1}{2} \int_0^{2\pi} [a\cos t \cdot b\cos t - b\sin t \cdot (-a\sin t)] \, dt$$
                        $$= \frac{1}{2} \int_0^{2\pi} (ab\cos^2 t + ab\sin^2 t) \, dt = \frac{ab}{2} \int_0^{2\pi} dt = \pi ab$$
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 11.3.2 平面上曲线积分与路径无关的条件 -->
        <div class="content-section">
            <div class="section-header">
                <h2>11.3.2 平面上曲线积分与路径无关的条件</h2>
            </div>
            <div class="section-content">
                <div class="definition">
                    <h4>路径无关的定义</h4>
                    <p>设 $D$ 是平面上的一个区域，如果对于 $D$ 内任意两点 $A$ 和 $B$，曲线积分 $\int_L P \, dx + Q \, dy$ 的值只依赖于起点 $A$ 和终点 $B$，而与连接 $A$、$B$ 的路径 $L$ 的选择无关，则称该曲线积分在区域 $D$ 内<strong>与路径无关</strong>。</p>
                </div>
                
                <div class="theorem">
                    <h4>路径无关的等价条件</h4>
                    <p>设 $D$ 是单连通区域，$P(x,y)$、$Q(x,y)$ 在 $D$ 内具有一阶连续偏导数，则下列条件等价：</p>
                    
                    <div class="conditions-grid">
                        <div class="condition-card">
                            <h5>条件1</h5>
                            <p>曲线积分 $\int_L P \, dx + Q \, dy$ 在 $D$ 内与路径无关</p>
                        </div>
                        <div class="condition-card">
                            <h5>条件2</h5>
                            <p>对 $D$ 内任意闭曲线 $C$：$\oint_C P \, dx + Q \, dy = 0$</p>
                        </div>
                        <div class="condition-card">
                            <h5>条件3</h5>
                            <p>在 $D$ 内处处有：$\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}$</p>
                        </div>
                        <div class="condition-card">
                            <h5>条件4</h5>
                            <p>存在函数 $u(x,y)$ 使得：$du = P \, dx + Q \, dy$</p>
                        </div>
                    </div>
                </div>
                
                <div class="important-box">
                    <h4>判定方法</h4>
                    <p>要判断曲线积分 $\int_L P \, dx + Q \, dy$ 是否与路径无关，最常用的方法是检验：</p>
                    <div class="math-expression">
                        $$\frac{\partial P}{\partial y} \stackrel{?}{=} \frac{\partial Q}{\partial x}$$
                    </div>
                    <p>如果在单连通区域内等式成立，则积分与路径无关；否则与路径有关。</p>
                </div>
                
                <div class="example">
                    <h4>例3：判断路径无关性</h4>
                    <p>判断积分 $\int_L (2xy + 3) \, dx + (x^2 + 2y) \, dy$ 是否与路径无关。</p>
                    
                    <div class="step-by-step">
                        <h5>解：</h5>
                        <p>$P(x,y) = 2xy + 3$，$Q(x,y) = x^2 + 2y$</p>
                        <p>计算偏导数：</p>
                        $$\frac{\partial P}{\partial y} = 2x, \quad \frac{\partial Q}{\partial x} = 2x$$
                        <p>因为 $\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x} = 2x$，所以积分与路径无关。</p>
                    </div>
                </div>
                
                <div class="example">
                    <h4>例4：计算与路径无关的积分</h4>
                    <p>计算 $\int_{(0,0)}^{(1,1)} (2xy + 3) \, dx + (x^2 + 2y) \, dy$。</p>
                    
                    <div class="step-by-step">
                        <h5>解法一：选择简单路径</h5>
                        <p>由于积分与路径无关，选择路径：先从 $(0,0)$ 到 $(1,0)$，再从 $(1,0)$ 到 $(1,1)$</p>
                        <p>第一段：$y = 0$，$dy = 0$，$x$ 从 $0$ 到 $1$</p>
                        $$\int_0^1 (0 + 3) \, dx = 3$$
                        <p>第二段：$x = 1$，$dx = 0$，$y$ 从 $0$ 到 $1$</p>
                        $$\int_0^1 (1 + 2y) \, dy = [y + y^2]_0^1 = 2$$
                        <p>总积分值：$3 + 2 = 5$</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 11.3.3 二元函数的全微分求积 -->
        <div class="content-section">
            <div class="section-header">
                <h2>11.3.3 二元函数的全微分求积</h2>
            </div>
            <div class="section-content">
                <div class="definition">
                    <h4>全微分方程</h4>
                    <p>如果微分表达式 $P(x,y) \, dx + Q(x,y) \, dy$ 满足条件 $\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}$，则存在函数 $u(x,y)$ 使得：</p>
                    <div class="math-expression">
                        $$du = P(x,y) \, dx + Q(x,y) \, dy$$
                    </div>
                    <p>此时称 $P \, dx + Q \, dy$ 为<strong>全微分</strong>，相应的微分方程 $P \, dx + Q \, dy = 0$ 称为<strong>全微分方程</strong>。</p>
                </div>
                
                <div class="theorem">
                    <h4>求原函数的方法</h4>
                    <p>设 $\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}$，求函数 $u(x,y)$ 使得 $\frac{\partial u}{\partial x} = P$，$\frac{\partial u}{\partial y} = Q$。</p>
                    
                    <div class="formula-card">
                        <h5>方法一：逐次积分法</h5>
                        <ol>
                            <li>对 $\frac{\partial u}{\partial x} = P(x,y)$ 关于 $x$ 积分：$u(x,y) = \int P(x,y) \, dx + \phi(y)$</li>
                            <li>将结果对 $y$ 求偏导：$\frac{\partial u}{\partial y} = \frac{\partial}{\partial y}\int P(x,y) \, dx + \phi'(y)$</li>
                            <li>利用 $\frac{\partial u}{\partial y} = Q(x,y)$ 确定 $\phi'(y)$，进而求出 $\phi(y)$</li>
                        </ol>
                    </div>
                    
                    <div class="formula-card">
                        <h5>方法二：曲线积分法</h5>
                        <p>$u(x,y) = \int_{(x_0,y_0)}^{(x,y)} P(x,y) \, dx + Q(x,y) \, dy + C$</p>
                        <p>其中 $(x_0, y_0)$ 是任选的定点，积分与路径无关。</p>
                    </div>
                </div>
                
                <div class="example">
                    <h4>例5：求全微分的原函数</h4>
                    <p>求微分式 $(2xy + 3) \, dx + (x^2 + 2y) \, dy$ 的原函数。</p>
                    
                    <div class="step-by-step">
                        <h5>解法一：逐次积分法</h5>
                        <p><strong>步骤1：</strong>对 $x$ 积分</p>
                        $$u(x,y) = \int (2xy + 3) \, dx = x^2y + 3x + \phi(y)$$
                        <p><strong>步骤2：</strong>对 $y$ 求偏导</p>
                        $$\frac{\partial u}{\partial y} = x^2 + \phi'(y)$$
                        <p><strong>步骤3：</strong>利用条件 $\frac{\partial u}{\partial y} = x^2 + 2y$</p>
                        $$x^2 + \phi'(y) = x^2 + 2y$$
                        <p>所以 $\phi'(y) = 2y$，$\phi(y) = y^2 + C_1$</p>
                        <p><strong>结果：</strong>$u(x,y) = x^2y + 3x + y^2 + C$</p>
                    </div>
                </div>
                
                <div class="application-box">
                    <h4>全微分方程的应用</h4>
                    <p>全微分方程在物理学和工程学中有重要应用：</p>
                    <ul>
                        <li><strong>热力学：</strong>描述状态函数的变化</li>
                        <li><strong>电磁学：</strong>保守场的势函数</li>
                        <li><strong>力学：</strong>保守力的势能函数</li>
                        <li><strong>几何学：</strong>正交轨线问题</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 11.3.4 曲线积分的基本定理和保守场 -->
        <div class="content-section">
            <div class="section-header">
                <h2>11.3.4 曲线积分的基本定理与保守场</h2>
            </div>
            <div class="section-content">
                <div class="theorem">
                    <h4>曲线积分的基本定理</h4>
                    <p>设 $u(x,y)$ 在区域 $D$ 内具有一阶连续偏导数，$L$ 是 $D$ 内从点 $A(x_1, y_1)$ 到点 $B(x_2, y_2)$ 的任意路径，则：</p>
                    <div class="math-expression">
                        $$\int_L \frac{\partial u}{\partial x} \, dx + \frac{\partial u}{\partial y} \, dy = u(x_2, y_2) - u(x_1, y_1)$$
                    </div>
                    <p>这是牛顿-莱布尼茨公式在曲线积分中的推广。</p>
                </div>
                
                <div class="definition">
                    <h4>保守场与势函数</h4>
                    <p>设向量场 $\vec{F}(x,y) = P(x,y)\vec{i} + Q(x,y)\vec{j}$ 在区域 $D$ 内满足：</p>
                    <div class="math-expression">
                        $$\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}$$
                    </div>
                    <p>则称 $\vec{F}$ 为<strong>保守场</strong>或<strong>有势场</strong>。此时存在标量函数 $u(x,y)$（称为<strong>势函数</strong>）使得：</p>
                    <div class="math-expression">
                        $$\vec{F} = \nabla u = \frac{\partial u}{\partial x}\vec{i} + \frac{\partial u}{\partial y}\vec{j}$$
                    </div>
                </div>
                
                <div class="important-box">
                    <h4>保守场的性质</h4>
                    <ol>
                        <li><strong>做功与路径无关：</strong>保守场中质点从一点移动到另一点，场力所做的功只与起点和终点有关</li>
                        <li><strong>沿闭路径做功为零：</strong>$\oint_C \vec{F} \cdot d\vec{r} = 0$</li>
                        <li><strong>势能守恒：</strong>在保守场中，系统的机械能守恒</li>
                        <li><strong>环流量为零：</strong>$\text{rot } \vec{F} = \frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} = 0$</li>
                    </ol>
                </div>
                
                <div class="example">
                    <h4>例6：验证保守场并求势函数</h4>
                    <p>验证向量场 $\vec{F}(x,y) = (2x + y)\vec{i} + (x + 2y)\vec{j}$ 是否为保守场，若是，求其势函数。</p>
                    
                    <div class="step-by-step">
                        <h5>解：</h5>
                        <p><strong>步骤1：</strong>验证保守场条件</p>
                        <p>$P = 2x + y$，$Q = x + 2y$</p>
                        $$\frac{\partial P}{\partial y} = 1, \quad \frac{\partial Q}{\partial x} = 1$$
                        <p>因为 $\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}$，所以是保守场。</p>
                        
                        <p><strong>步骤2：</strong>求势函数</p>
                        <p>设势函数为 $u(x,y)$，则：</p>
                        $$\frac{\partial u}{\partial x} = 2x + y$$
                        <p>对 $x$ 积分：$u = x^2 + xy + \phi(y)$</p>
                        <p>对 $y$ 求偏导：$\frac{\partial u}{\partial y} = x + \phi'(y)$</p>
                        <p>由 $\frac{\partial u}{\partial y} = x + 2y$ 得：$\phi'(y) = 2y$，所以 $\phi(y) = y^2 + C$</p>
                        <p><strong>结果：</strong>势函数为 $u(x,y) = x^2 + xy + y^2 + C$</p>
                    </div>
                </div>
                
                <div class="example">
                    <h4>例7：利用势函数计算功</h4>
                    <p>在上例的保守场中，计算质点从 $(0,0)$ 移动到 $(1,2)$ 时场力所做的功。</p>
                    
                    <div class="step-by-step">
                        <h5>解：</h5>
                        <p>由于是保守场，做功等于势函数的增量：</p>
                        $$W = u(1,2) - u(0,0) = (1 + 2 + 4) - (0) = 7$$
                        <p>无论选择什么路径，功都是 $7$。</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="nav-buttons">
            <a href="11.2.html" class="btn prev">上一节：11.2 对坐标的曲线积分</a>
            <a href="11.4.html" class="btn next">下一节：11.4 对面积的曲面积分</a>
        </div>
        
        <footer>
            <p>&copy; 2025 高等数学复习系统 - 曲线积分与曲面积分</p>
        </footer>
    </div>

    <script>
        // 页面加载完成后的动画效果
        document.addEventListener('DOMContentLoaded', function() {
            // 为内容区块添加入场动画
            const sections = document.querySelectorAll('.content-section');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(30px)';
                setTimeout(() => {
                    section.style.transition = 'all 0.8s ease';
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 200);
            });
            
            // 为定义、定理、例子添加悬停效果
            const boxes = document.querySelectorAll('.definition, .theorem, .example, .application-box, .important-box');
            boxes.forEach(box => {
                box.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateX(5px)';
                });
                
                box.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateX(0)';
                });
            });
            
            // 初始化格林公式可视化
            initGreenVisualization();
        });
        
        // 格林公式可视化 - 使用D3.js
        function initGreenVisualization() {
            const container = d3.select('#green-visualization');
            
            // 设置画布尺寸
            const width = 800;
            const height = 450;
            const margin = {top: 20, right: 20, bottom: 30, left: 30};
            const innerWidth = width - margin.left - margin.right;
            const innerHeight = height - margin.top - margin.bottom;
            
            // 创建SVG
            const svg = container.append('svg')
                .attr('width', width)
                .attr('height', height);
            
            // 定义箭头标记
            const defs = svg.append('defs');
            
            // 向量场箭头
            defs.append('marker')
                .attr('id', 'vector-arrowhead')
                .attr('viewBox', '0 -5 10 10')
                .attr('refX', 8)
                .attr('refY', 0)
                .attr('markerWidth', 4)
                .attr('markerHeight', 4)
                .attr('orient', 'auto')
                .append('path')
                .attr('d', 'M0,-5L10,0L0,5')
                .attr('fill', '#3498db');
            
            // 边界箭头
            defs.append('marker')
                .attr('id', 'boundary-arrowhead')
                .attr('viewBox', '0 -5 10 10')
                .attr('refX', 8)
                .attr('refY', 0)
                .attr('markerWidth', 5)
                .attr('markerHeight', 5)
                .attr('orient', 'auto')
                .append('path')
                .attr('d', 'M0,-5L10,0L0,5')
                .attr('fill', '#e74c3c');
            
            // 创建主绘图区
            const g = svg.append('g')
                .attr('transform', `translate(${margin.left}, ${margin.top})`);
            
            // 设置坐标比例 - 确保x和y轴比例一致，圆形是真正的圆
            const maxRange = 200;
            const xScale = d3.scaleLinear()
                .domain([-maxRange, maxRange])
                .range([0, innerWidth]);
            
            const yScale = d3.scaleLinear()
                .domain([-maxRange * innerHeight / innerWidth, maxRange * innerHeight / innerWidth])
                .range([innerHeight, 0]);
            
            const centerX = xScale(0);
            const centerY = yScale(0);
            
            // 计算y轴的最大范围（保持比例一致）
            const yMaxRange = maxRange * innerHeight / innerWidth;
            
            // 绘制网格 - 根据新的比例调整
            const gridGroup = g.append('g').attr('class', 'grid');
            
            // 垂直网格线
            for (let x = -maxRange; x <= maxRange; x += 40) {
                gridGroup.append('line')
                    .attr('class', 'grid-line')
                    .attr('x1', xScale(x))
                    .attr('y1', 0)
                    .attr('x2', xScale(x))
                    .attr('y2', innerHeight);
            }
            
            // 水平网格线
            for (let y = -yMaxRange; y <= yMaxRange; y += 40) {
                gridGroup.append('line')
                    .attr('class', 'grid-line')
                    .attr('x1', 0)
                    .attr('y1', yScale(y))
                    .attr('x2', innerWidth)
                    .attr('y2', yScale(y));
            }
            
            // 绘制坐标轴
            g.append('line')
                .attr('class', 'axis')
                .attr('x1', 0)
                .attr('y1', centerY)
                .attr('x2', innerWidth)
                .attr('y2', centerY);
                
            g.append('line')
                .attr('class', 'axis')
                .attr('x1', centerX)
                .attr('y1', 0)
                .attr('x2', centerX)
                .attr('y2', innerHeight);
            
            // 向量场函数：F = (-y, x) 表示逆时针旋转
            function vectorField(x, y) {
                return {
                    u: -y * 0.01,  // F_x = -y
                    v: x * 0.01    // F_y = x
                };
            }
            
            // 绘制向量场 - 根据新的比例调整范围
            const vectorGroup = g.append('g').attr('class', 'vector-field');
            
            for (let x = -180; x <= 180; x += 30) {
                for (let y = -yMaxRange + 20; y <= yMaxRange - 20; y += 30) {
                    const vector = vectorField(x, y);
                    const scale = 15;  // 向量长度缩放
                    
                    const startX = xScale(x);
                    const startY = yScale(y);
                    const endX = xScale(x + vector.u * scale);
                    const endY = yScale(y + vector.v * scale);
                    
                    // 只有当向量足够长时才绘制
                    const vectorLength = Math.sqrt(vector.u * vector.u + vector.v * vector.v) * scale;
                    if (vectorLength > 2) {
                        vectorGroup.append('line')
                            .attr('class', 'vector-arrow')
                            .attr('x1', startX)
                            .attr('y1', startY)
                            .attr('x2', endX)
                            .attr('y2', endY);
                    }
                }
            }
            
            // 绘制圆形区域 - 现在应该是真正的圆形
            const radius = 100;
            g.append('circle')
                .attr('class', 'region-circle')
                .attr('cx', centerX)
                .attr('cy', centerY)
                .attr('r', Math.abs(xScale(radius) - xScale(0)));  // 使用x轴的比例来确保圆形
            
            // 绘制边界方向箭头（逆时针）
            const boundaryGroup = g.append('g').attr('class', 'boundary-arrows');
            
            for (let i = 0; i < 8; i++) {
                const angle = i * Math.PI / 4;
                // 箭头起点就在圆形边界上
                const x = radius * Math.cos(angle);
                const y = radius * Math.sin(angle);
                
                // 逆时针切线方向：(-sin(θ), cos(θ))
                const dx = -Math.sin(angle);
                const dy = Math.cos(angle);
                
                const arrowLength = 10;  // 箭头长度
                const startX = xScale(x);
                const startY = yScale(y);
                const endX = xScale(x + dx * arrowLength);
                const endY = yScale(y + dy * arrowLength);
                
                boundaryGroup.append('line')
                    .attr('class', 'boundary-arrow')
                    .attr('x1', startX)
                    .attr('y1', startY)
                    .attr('x2', endX)
                    .attr('y2', endY);
            }
            
            // 添加说明文字
            const textGroup = g.append('g').attr('class', 'explanations');
            
            textGroup.append('text')
                .attr('class', 'explanation-text')
                .attr('x', 10)
                .attr('y', 20)
                .text('格林公式: ∮ P dx + Q dy = ∬ (∂Q/∂x - ∂P/∂y) dx dy');
            
            textGroup.append('text')
                .attr('class', 'explanation-text')
                .attr('x', 10)
                .attr('y', 35)
                .text('向量场 F = (-y, x)，蓝色箭头显示向量场方向');
            
            textGroup.append('text')
                .attr('class', 'explanation-text')
                .attr('x', 10)
                .attr('y', 50)
                .text('红色箭头显示边界逆时针正方向，绿色圆形为积分区域');
            
            textGroup.append('text')
                .attr('class', 'explanation-text')
                .attr('x', 10)
                .attr('y', 65)
                .text('对于该向量场，∂Q/∂x - ∂P/∂y = 1 - (-1) = 2');
        }
    </script>
</body>
</html>
